import{c as x,t as T,r as c,j as e,L as f,B as n,U as p,q as o,F as C,f as L,h as E,E as V,J as w,e as $}from"./index-p7G8qfj7.js";import{C as N,a as j}from"./card-CYsiFTst.js";import{L as l}from"./label-C4vWMX2d.js";import{B as M,a as S,b as g,c as A,d as B,e as F}from"./breadcrumb-CrKu09cC.js";import{P as G}from"./phone-input-D3QiRiqo.js";import{A as z}from"./arrow-left-DCGsBlj7.js";import{C as J}from"./calendar-CbjgMhWF.js";import{E as H}from"./eye-off-BYLkuJSM.js";import{S as O}from"./save-CCJbauxk.js";import"./index-tz47Xmli.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=x("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=x("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=x("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=x("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=x("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),v=s=>{if(!s)return{firstName:"",lastName:""};const h=s.trim().split(/\s+/);return{firstName:h[0]||"",lastName:h.slice(1).join(" ")||""}},de=()=>{const{user:s,updateUser:h}=T(),[m,b]=c.useState(!1),[u,_]=c.useState(!1),[a,t]=c.useState({firstName:v(s==null?void 0:s.full_name).firstName,lastName:v(s==null?void 0:s.full_name).lastName,email:(s==null?void 0:s.email)||"",phone:(s==null?void 0:s.phone)||"",newPassword:"",confirmPassword:""}),[y,k]=c.useState(!1);c.useEffect(()=>{if(s){const r=v(s.full_name);t(i=>({...i,firstName:r.firstName,lastName:r.lastName,email:s.email||i.email,phone:s.phone||i.phone}))}},[s]);const q=r=>{switch(r){case"director":return"Approbateur N2";case"supervisor":return"Approbateur N1";case"user":return"Demandeur";case"administrator":return"Administrateur";default:return r}},U=r=>{switch(r){case"administrator":return"destructive";case"supervisor":return"default";case"director":return"secondary";case"user":return"outline";default:return"outline"}},D=async()=>{var r,i;k(!0);try{if(a.newPassword&&a.newPassword!==a.confirmPassword){w.error("Les mots de passe ne correspondent pas"),k(!1);return}const d=`${a.firstName||""} ${a.lastName||""}`.trim(),P={full_name:d,email:a.email};a.phone&&(P.phone=a.phone),a.newPassword&&(P.password=a.newPassword),(await $.put(`/users/${s==null?void 0:s.id}`,P)).data?(h({full_name:d,email:a.email,phone:a.phone||(s==null?void 0:s.phone)||""}),w.success("Profil mis à jour avec succès"),b(!1),t({...a,newPassword:"",confirmPassword:""})):w.error("Erreur lors de la mise à jour du profil")}catch(d){console.error("Error updating profile:",d),w.error(((i=(r=d.response)==null?void 0:r.data)==null?void 0:i.message)||"Erreur lors de la mise à jour du profil")}finally{k(!1)}},R=()=>{b(!1);const r=v(s==null?void 0:s.full_name);t({firstName:r.firstName,lastName:r.lastName,email:(s==null?void 0:s.email)||"",phone:(s==null?void 0:s.phone)||"",newPassword:"",confirmPassword:""})};return s?e.jsxs("div",{className:"w-full p-3 sm:p-4 md:p-6 space-y-4 sm:space-y-6 overflow-x-hidden box-border",children:[e.jsx(N,{className:"bg-card rounded-lg border",children:e.jsx(j,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[e.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-full bg-blue-600 flex items-center justify-center",children:e.jsx(I,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-foreground break-words mb-1",children:"Mon Profil"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground break-words mb-2",children:"Gérez vos informations personnelles"}),e.jsx(M,{children:e.jsxs(S,{children:[e.jsx(g,{children:e.jsx(A,{asChild:!0,children:e.jsx(f,{to:"/",children:"Tableau de bord"})})}),e.jsx(B,{}),e.jsx(g,{children:e.jsx(F,{children:"Mon Profil"})})]})})]})]}),e.jsx(n,{variant:"outline",size:"icon",className:"flex-shrink-0 rounded-full w-10 h-10",asChild:!0,children:e.jsx(f,{to:"/",children:e.jsx(z,{className:"w-4 h-4"})})})]})})}),!m&&e.jsx("div",{className:"flex justify-end mr-2",children:e.jsxs(n,{onClick:()=>b(!0),className:"gap-2 text-sm",children:[e.jsx(X,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Modifier le profil"}),e.jsx("span",{className:"sm:hidden",children:"Modifier"})]})}),e.jsx(N,{className:"w-full min-w-0 box-border",children:e.jsxs(j,{className:"p-3 sm:p-4 md:p-6 space-y-4 sm:space-y-6 md:space-y-8",children:[e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b",children:[e.jsx(p,{className:"w-4 h-4 sm:w-5 sm:h-5 text-primary flex-shrink-0"}),e.jsx("h2",{className:"text-base sm:text-lg md:text-xl font-semibold",children:"Informations personnelles"})]}),e.jsxs("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2 w-full min-w-0",children:[e.jsx(l,{htmlFor:"firstName",className:"text-xs sm:text-sm",children:"Prénom"}),m?e.jsx(o,{id:"firstName",value:a.firstName,onChange:r=>t({...a,firstName:r.target.value}),placeholder:"Prénom",className:"w-full min-w-0 text-sm"}):e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-md bg-muted min-w-0",children:[e.jsx(p,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{className:"text-xs sm:text-sm truncate",children:a.firstName||"-"})]})]}),e.jsxs("div",{className:"space-y-2 w-full min-w-0",children:[e.jsx(l,{htmlFor:"lastName",className:"text-xs sm:text-sm",children:"Nom"}),m?e.jsx(o,{id:"lastName",value:a.lastName,onChange:r=>t({...a,lastName:r.target.value}),placeholder:"Nom",className:"w-full min-w-0 text-sm"}):e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-md bg-muted min-w-0",children:[e.jsx(p,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{className:"text-xs sm:text-sm truncate",children:a.lastName||"-"})]})]}),e.jsxs("div",{className:"space-y-2 w-full min-w-0",children:[e.jsx(l,{htmlFor:"email",className:"text-xs sm:text-sm",children:"Email"}),m?e.jsx(o,{id:"email",type:"email",value:a.email,onChange:r=>t({...a,email:r.target.value}),placeholder:"Email",className:"w-full min-w-0 text-sm"}):e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-md bg-muted min-w-0",children:[e.jsx(Q,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{className:"text-xs sm:text-sm truncate",children:s.email})]})]}),e.jsxs("div",{className:"space-y-2 w-full min-w-0",children:[e.jsx(l,{htmlFor:"phone",className:"text-xs sm:text-sm",children:"Téléphone"}),m?e.jsx(G,{id:"phone",value:a.phone,onChange:r=>t({...a,phone:r||""}),placeholder:"Numéro de téléphone",className:"w-full min-w-0 text-sm"}):e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-md bg-muted min-w-0",children:[e.jsx(W,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{className:"text-xs sm:text-sm truncate",children:s.phone||a.phone||"Non renseigné"})]})]}),e.jsxs("div",{className:"space-y-2 w-full min-w-0",children:[e.jsx(l,{htmlFor:"username",className:"text-xs sm:text-sm",children:"Nom d'utilisateur"}),e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-md bg-muted min-w-0",children:[e.jsx(p,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{className:"text-xs sm:text-sm truncate",children:s.username})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Le nom d'utilisateur ne peut pas être modifié"})]})]})]}),e.jsx(C,{}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b",children:[e.jsx(L,{className:"w-4 h-4 sm:w-5 sm:h-5 text-primary flex-shrink-0"}),e.jsx("h2",{className:"text-base sm:text-lg md:text-xl font-semibold",children:"Informations de compte"})]}),e.jsxs("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2 w-full min-w-0",children:[e.jsx(l,{className:"text-xs sm:text-sm",children:"Rôle"}),e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-md bg-muted min-w-0",children:[e.jsx(L,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-muted-foreground flex-shrink-0"}),e.jsx(E,{variant:U(s.role),className:"text-xs sm:text-sm",children:q(s.role)})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Le rôle ne peut pas être modifié"})]}),e.jsxs("div",{className:"space-y-2 w-full min-w-0",children:[e.jsx(l,{className:"text-xs sm:text-sm",children:"Statut"}),e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-md bg-muted min-w-0",children:[e.jsx(J,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-muted-foreground flex-shrink-0"}),e.jsx(E,{variant:s.is_active?"default":"secondary",className:"text-xs sm:text-sm",children:s.is_active?"Actif":"Inactif"})]})]})]})]}),e.jsx(C,{}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b",children:[e.jsx(K,{className:"w-4 h-4 sm:w-5 sm:h-5 text-primary flex-shrink-0"}),e.jsx("h2",{className:"text-base sm:text-lg md:text-xl font-semibold",children:"Modification du mot de passe"})]}),m?e.jsxs("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2 w-full min-w-0",children:[e.jsx(l,{htmlFor:"newPassword",className:"text-xs sm:text-sm",children:"Nouveau mot de passe"}),e.jsxs("div",{className:"relative w-full min-w-0",children:[e.jsx(o,{id:"newPassword",type:u?"text":"password",value:a.newPassword,onChange:r=>t({...a,newPassword:r.target.value}),placeholder:"Nouveau mot de passe",className:"w-full min-w-0 pr-10 text-sm"}),e.jsx(n,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-1/2 -translate-y-1/2 h-8 w-8 p-0 hover:bg-transparent",onClick:()=>_(!u),children:u?e.jsx(H,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"}):e.jsx(V,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})})]})]}),e.jsxs("div",{className:"space-y-2 w-full min-w-0",children:[e.jsx(l,{htmlFor:"confirmPassword",className:"text-xs sm:text-sm",children:"Confirmer le mot de passe"}),e.jsx(o,{id:"confirmPassword",type:u?"text":"password",value:a.confirmPassword,onChange:r=>t({...a,confirmPassword:r.target.value}),placeholder:"Confirmer le nouveau mot de passe",className:"w-full min-w-0 text-sm"})]})]}):e.jsx("div",{className:"p-3 sm:p-4 rounded-md bg-muted",children:e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:'Cliquez sur "Modifier le profil" pour changer votre mot de passe.'})})]}),m&&e.jsxs(e.Fragment,{children:[e.jsx(C,{}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 sm:gap-4",children:[e.jsx(n,{variant:"outline",onClick:R,disabled:y,className:"w-full sm:w-auto text-sm",children:"Annuler"}),e.jsxs(n,{onClick:D,disabled:y,className:"w-full sm:w-auto text-sm",children:[e.jsx(O,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 mr-2"}),y?"Enregistrement...":"Enregistrer les modifications"]})]})]})]})})]}):e.jsxs("div",{className:"w-full p-3 sm:p-4 md:p-6 space-y-4 sm:space-y-6 overflow-x-hidden box-border",children:[e.jsx(N,{className:"bg-card rounded-lg border",children:e.jsx(j,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[e.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-full bg-blue-600 flex items-center justify-center",children:e.jsx(I,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-foreground break-words mb-1",children:"Mon Profil"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground break-words mb-2",children:"Gérez vos informations personnelles"}),e.jsx(M,{children:e.jsxs(S,{children:[e.jsx(g,{children:e.jsx(A,{asChild:!0,children:e.jsx(f,{to:"/",children:"Tableau de bord"})})}),e.jsx(B,{}),e.jsx(g,{children:e.jsx(F,{children:"Mon Profil"})})]})})]})]}),e.jsx(n,{variant:"outline",size:"icon",className:"flex-shrink-0 rounded-full w-10 h-10",asChild:!0,children:e.jsx(f,{to:"/",children:e.jsx(z,{className:"w-4 h-4"})})})]})})}),e.jsx(N,{className:"w-full min-w-0 box-border",children:e.jsx(j,{className:"p-6 sm:p-12 text-center",children:e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Aucune information utilisateur disponible."})})})]})};export{de as default};
