import{ap as D,s as B,r as i,e as L,j as e,S as x,B as w,ab as y,h as r}from"./index-Cm5HjFIo.js";import{C as o,a as m,b as v,c as C}from"./card-C-b0mMpV.js";import{T as _,a as I,b as T,c as l,d as H,e as n}from"./table-CWxHh_dS.js";import{A}from"./arrow-left-CILDDhBu.js";import{A as E}from"./activity-CBFhauUw.js";function P(s){switch(s==null?void 0:s.toLowerCase()){case"active":return e.jsx(r,{className:"bg-green-600 text-white text-xs font-bold",children:"ACTIF"});case"bypassed":return e.jsx(r,{className:"bg-orange-500 text-white text-xs font-bold",children:"BYPASS"});case"maintenance":return e.jsx(r,{className:"bg-yellow-500 text-white text-xs font-bold",children:"MAINTENANCE"});case"faulty":return e.jsx(r,{className:"bg-red-600 text-white text-xs font-bold",children:"DÉFAUT"});case"calibration":return e.jsx(r,{className:"bg-blue-500 text-white text-xs font-bold",children:"CALIBRATION"});default:return e.jsx(r,{variant:"outline",className:"text-xs",children:s})}}function F(s){switch(s==null?void 0:s.toLowerCase()){case"approved":return e.jsx(r,{className:"bg-green-600 text-white text-xs font-bold",children:"APPROUVÉ"});case"pending":return e.jsx(r,{className:"bg-yellow-500 text-white text-xs font-bold",children:"EN ATTENTE"});case"rejected":return e.jsx(r,{className:"bg-red-600 text-white text-xs font-bold",children:"REJETÉ"});case"expired":return e.jsx(r,{className:"bg-orange-500 text-white text-xs font-bold",children:"EXPIRÉ"});case"closed":return e.jsx(r,{className:"bg-gray-600 text-white text-xs font-bold",children:"CLÔTURÉ"});default:return e.jsx(r,{variant:"outline",className:"text-xs",children:s})}}function u(s){return s?new Date(s).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"—"}function O(){var N,f,g;const{id:s}=D(),h=B(),[t,S]=i.useState(null),[R,p]=i.useState(!0),[j,q]=i.useState(null);if(i.useEffect(()=>{L.get(`/sensors/${s}`).then(a=>{var b;const c=((b=a.data)==null?void 0:b.data)||a.data;S(c),p(!1)}).catch(a=>{var c;q(((c=a.response)==null?void 0:c.status)===404?"Capteur introuvable":"Erreur lors du chargement"),p(!1)})},[s]),R)return e.jsxs("div",{className:"w-full p-4 md:p-6 space-y-6",children:[e.jsx(x,{className:"h-8 w-48"}),e.jsx(x,{className:"h-48 w-full"}),e.jsx(x,{className:"h-64 w-full"})]});if(j||!t)return e.jsxs("div",{className:"w-full p-4 md:p-6 space-y-6",children:[e.jsxs(w,{variant:"ghost",onClick:()=>h("/sensors"),className:"gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),"Retour à la liste"]}),e.jsx(o,{children:e.jsxs(m,{className:"py-12 text-center text-muted-foreground",children:[e.jsx(y,{className:"w-10 h-10 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:j||"Capteur introuvable"})]})})]});const d=t.bypass_history||[];return e.jsxs("div",{className:"w-full p-4 md:p-6 space-y-6",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(w,{variant:"ghost",onClick:()=>h("/sensors"),className:"gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),"Retour à la liste"]})}),e.jsxs(o,{children:[e.jsx(v,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(C,{className:"flex items-center gap-2 text-lg",children:[e.jsx(y,{className:"w-5 h-5"}),t.code]}),P(t.status)]})}),e.jsx(m,{children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Nom"}),e.jsx("p",{className:"font-medium",children:t.name})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Type"}),e.jsx("p",{className:"font-medium",children:t.type})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Unité"}),e.jsx("p",{className:"font-medium",children:t.unite||"—"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Seuil critique"}),e.jsx("p",{className:"font-medium",children:t.seuil_critique!=null?`${t.seuil_critique} ${t.unite||""}`:"—"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Équipement"}),e.jsx("p",{className:"font-medium",children:((N=t.equipment)==null?void 0:N.name)||"—"}),((g=(f=t.equipment)==null?void 0:f.zone)==null?void 0:g.name)&&e.jsx("p",{className:"text-xs text-muted-foreground",children:t.equipment.zone.name})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Dernier étalonnage"}),e.jsx("p",{className:"font-medium",children:u(t.Dernier_Etallonnage)})]})]})})]}),e.jsxs(o,{children:[e.jsx(v,{className:"pb-3",children:e.jsxs(C,{className:"flex items-center gap-2 text-lg",children:[e.jsx(E,{className:"w-5 h-5"}),"Historique des bypass (",d.length,")"]})}),e.jsx(m,{children:d.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(E,{className:"w-10 h-10 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"Aucun bypass enregistré pour ce capteur"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(_,{children:[e.jsx(I,{children:e.jsxs(T,{children:[e.jsx(l,{className:"text-xs font-semibold uppercase text-muted-foreground",children:"Code"}),e.jsx(l,{className:"text-xs font-semibold uppercase text-muted-foreground",children:"Statut"}),e.jsx(l,{className:"text-xs font-semibold uppercase text-muted-foreground",children:"Début"}),e.jsx(l,{className:"text-xs font-semibold uppercase text-muted-foreground",children:"Fin"}),e.jsx(l,{className:"text-xs font-semibold uppercase text-muted-foreground",children:"Motif"}),e.jsx(l,{className:"text-xs font-semibold uppercase text-muted-foreground",children:"Demandeur"})]})}),e.jsx(H,{children:d.map(a=>e.jsxs(T,{className:"hover:bg-muted/50",children:[e.jsx(n,{className:"font-mono text-sm font-semibold text-primary",children:a.bypass_code||"—"}),e.jsx(n,{children:F(a.status)}),e.jsx(n,{className:"text-sm",children:u(a.start_time)}),e.jsx(n,{className:"text-sm",children:u(a.end_time)}),e.jsx(n,{className:"text-sm max-w-[200px] truncate",children:a.reason||"—"}),e.jsx(n,{className:"text-sm",children:a.requester_name||"—"})]},a.id))})]})})})]})]})}export{O as default};
