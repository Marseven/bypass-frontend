import{c as hs,i as Es,k as us,r as x,u as Vs,l as Bs,j as e,m as zs,P as Ze,n as Os,I as $s,o as We,p as Js,d as je,q as Hs,e as te,h as T,s as pe,B as $,X as Gs,t as Ys,v as js,w as ds,J as Xe,x as Us,L as Qe,y as Me,S as n,z as Ks,T as Zs}from"./index-DddjZrTs.js";import{g as U,p as xe,s as he}from"./statusLabels-Cvvyzy4o.js";import{C as p,a as f,b as P,c as M,d as ye}from"./card-HJdulpyU.js";import{L as ce}from"./label-BzSdYhZy.js";import{S as I,a as k,b as _,c as L,d as a}from"./select-DBKdREnk.js";import{P as Re,a as Ee,b as Q,c as Ve,d as Be,e as ze}from"./pagination-BKLQRlEH.js";import{B as Ws,a as Xs,b as ms,c as Qs,d as qs,e as ea}from"./breadcrumb-OwolTu12.js";import{F as E,a as V,b as R,c as B,d as G,o as sa,s as K,_ as be,e as os,f as xs,u as aa,g as ta,h as la}from"./form-CbInO8rD.js";import{T as Ke}from"./textarea-BNHvbM7Z.js";import{C as ss}from"./checkbox-D5z71oVW.js";import{P as na}from"./plus-ClRgL7g0.js";import{A as as}from"./arrow-left-Ds2cBaKb.js";import{S as ia}from"./save-DLcye4lx.js";import{R as ue,F as qe}from"./RequestDetailsModal-DaFmm6rM.js";import{P as Oe,a as $e,f as Je,b as He,C as Ge,c as Ye}from"./popover-DwAwAjVu.js";import{F as ae}from"./file-text-BLpMISKA.js";import{C as Ue}from"./calendar-W3rvNbsg.js";import{C as Ce}from"./circle-check-big-DYcsbzcm.js";import{A as ra}from"./activity-CR15hZLs.js";import{C as ca}from"./clock-DacBpcqM.js";import"./index-B6Fl2CXf.js";import"./map-pin-DJdWgtO6.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=hs("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=hs("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var ts="Tabs",[oa,qa]=Es(ts,[us]),ps=us(),[xa,ls]=oa(ts),fs=x.forwardRef((i,c)=>{const{__scopeTabs:h,value:t,onValueChange:d,defaultValue:u,orientation:l="horizontal",dir:m,activationMode:b="automatic",...o}=i,w=Vs(m),[D,F]=Bs({prop:t,onChange:d,defaultProp:u});return e.jsx(xa,{scope:h,baseId:zs(),value:D,onValueChange:F,orientation:l,dir:w,activationMode:b,children:e.jsx(Ze.div,{dir:w,"data-orientation":l,...o,ref:c})})});fs.displayName=ts;var gs="TabsList",ws=x.forwardRef((i,c)=>{const{__scopeTabs:h,loop:t=!0,...d}=i,u=ls(gs,h),l=ps(h);return e.jsx(Os,{asChild:!0,...l,orientation:u.orientation,dir:u.dir,loop:t,children:e.jsx(Ze.div,{role:"tablist","aria-orientation":u.orientation,...d,ref:c})})});ws.displayName=gs;var vs="TabsTrigger",Ns=x.forwardRef((i,c)=>{const{__scopeTabs:h,value:t,disabled:d=!1,...u}=i,l=ls(vs,h),m=ps(h),b=Cs(l.baseId,t),o=Ss(l.baseId,t),w=t===l.value;return e.jsx($s,{asChild:!0,...m,focusable:!d,active:w,children:e.jsx(Ze.button,{type:"button",role:"tab","aria-selected":w,"aria-controls":o,"data-state":w?"active":"inactive","data-disabled":d?"":void 0,disabled:d,id:b,...u,ref:c,onMouseDown:We(i.onMouseDown,D=>{!d&&D.button===0&&D.ctrlKey===!1?l.onValueChange(t):D.preventDefault()}),onKeyDown:We(i.onKeyDown,D=>{[" ","Enter"].includes(D.key)&&l.onValueChange(t)}),onFocus:We(i.onFocus,()=>{const D=l.activationMode!=="manual";!w&&!d&&D&&l.onValueChange(t)})})})});Ns.displayName=vs;var ys="TabsContent",bs=x.forwardRef((i,c)=>{const{__scopeTabs:h,value:t,forceMount:d,children:u,...l}=i,m=ls(ys,h),b=Cs(m.baseId,t),o=Ss(m.baseId,t),w=t===m.value,D=x.useRef(w);return x.useEffect(()=>{const F=requestAnimationFrame(()=>D.current=!1);return()=>cancelAnimationFrame(F)},[]),e.jsx(Js,{present:d||w,children:({present:F})=>e.jsx(Ze.div,{"data-state":w?"active":"inactive","data-orientation":m.orientation,role:"tabpanel","aria-labelledby":b,hidden:!F,id:o,tabIndex:0,...l,ref:c,style:{...i.style,animationDuration:D.current?"0s":void 0},children:F&&u})})});bs.displayName=ys;function Cs(i,c){return`${i}-trigger-${c}`}function Ss(i,c){return`${i}-content-${c}`}var ha=fs,As=ws,Is=Ns,ks=bs;const ua=ha,_s=x.forwardRef(({className:i,...c},h)=>e.jsx(As,{ref:h,className:je("inline-flex h-10 items-center justify-center rounded-md bg-muted/50 p-1 text-muted-foreground",i),...c}));_s.displayName=As.displayName;const Ie=x.forwardRef(({className:i,...c},h)=>e.jsx(Is,{ref:h,className:je("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-primary data-[state=active]:shadow-sm",i),...c}));Ie.displayName=Is.displayName;const ke=x.forwardRef(({className:i,...c},h)=>e.jsx(ks,{ref:h,className:je("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",i),...c}));ke.displayName=ks.displayName;function ja({steps:i,currentStep:c,onStepClick:h}){return e.jsx("nav",{"aria-label":"Progress",className:"mb-8",children:e.jsx("ol",{className:"flex items-center",children:i.map((t,d)=>e.jsxs("li",{className:je("relative flex-1",d!==i.length-1&&"pr-8 sm:pr-20"),children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{type:"button",onClick:()=>h==null?void 0:h(t.id),disabled:t.id>c+1,className:je("relative flex h-8 w-8 items-center justify-center rounded-full text-sm font-medium transition-colors",t.id<c?"bg-primary text-primary-foreground cursor-pointer":t.id===c?"border-2 border-primary bg-background text-primary":"border-2 border-muted bg-background text-muted-foreground"),children:t.id<c?e.jsx(Hs,{className:"h-4 w-4"}):t.id}),d!==i.length-1&&e.jsx("div",{className:je("absolute top-4 left-8 -ml-px h-0.5 w-full sm:left-20",t.id<c?"bg-primary":"bg-muted"),style:{width:"calc(100% - 2rem)"}})]}),e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:je("text-xs font-medium",t.id<=c?"text-primary":"text-muted-foreground"),children:t.title})})]},t.id))})})}const Ls={maintenance:"Maintenance",operationnel:"Opérationnel",permissif:"Permissif"},Ds={process:"Process",securite:"Sécurité"},Ts={court_terme:"Court terme (< 48h)",long_terme:"Long terme (≥ 48h)"},pa={na:"N/A",sil1:"SIL 1",sil2:"SIL 2",sil3:"SIL 3"},fa={process:"Process",securite:"Sécurité",feu_gaz:"Feu & Gaz"};function ga({form:i}){const[c,h]=x.useState([]),[t,d]=x.useState([]),[u,l]=x.useState([]),[m,b]=x.useState([]),[o,w]=x.useState(null),[D,F]=x.useState(null),le=i.watch("siteId"),X=i.watch("zoneId"),ne=i.watch("equipmentId"),re=i.watch("sensorId");return x.useEffect(()=>{te.get("/sites").then(C=>{h(C.data.data||[])}).catch(console.error)},[]),x.useEffect(()=>{le&&(te.get(`/zones?site_id=${le}`).then(C=>{d(C.data.data||[])}).catch(console.error),i.setValue("zoneId",""),i.setValue("equipmentId",""),i.setValue("sensorId",""),l([]),b([]))},[le]),x.useEffect(()=>{X&&(te.get(`/zones/${X}/equipements`).then(C=>{l(C.data||[])}).catch(console.error),i.setValue("equipmentId",""),i.setValue("sensorId",""),b([]))},[X]),x.useEffect(()=>{if(ne){const C=u.find(N=>String(N.id)===String(ne));w(C),C&&te.get(`/equipment/${C.id}/sensors`).then(N=>{b(N.data.data||[])}).catch(console.error),i.setValue("sensorId","")}},[ne,u]),x.useEffect(()=>{if(re){const C=m.find(N=>String(N.id)===String(re));F(C)}},[re,m]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(E,{control:i.control,name:"siteId",render:({field:C})=>e.jsxs(V,{children:[e.jsx(R,{children:"Site"}),e.jsxs(I,{onValueChange:C.onChange,value:C.value,children:[e.jsx(B,{children:e.jsx(k,{children:e.jsx(_,{placeholder:"Sélectionner un site"})})}),e.jsx(L,{children:c.map(N=>e.jsxs(a,{value:String(N.id),children:[N.code," - ",N.name]},N.id))})]}),e.jsx(G,{})]})}),e.jsx(E,{control:i.control,name:"zoneId",render:({field:C})=>e.jsxs(V,{children:[e.jsx(R,{children:"Zone"}),e.jsxs(I,{onValueChange:C.onChange,value:C.value,disabled:!le,children:[e.jsx(B,{children:e.jsx(k,{children:e.jsx(_,{placeholder:"Sélectionner une zone"})})}),e.jsx(L,{children:t.map(N=>e.jsx(a,{value:String(N.id),children:N.name},N.id))})]}),e.jsx(G,{})]})}),e.jsx(E,{control:i.control,name:"equipmentId",render:({field:C})=>e.jsxs(V,{children:[e.jsx(R,{children:"Equipement"}),e.jsxs(I,{onValueChange:C.onChange,value:C.value,disabled:!X,children:[e.jsx(B,{children:e.jsx(k,{children:e.jsx(_,{placeholder:"Sélectionner un équipement"})})}),e.jsx(L,{children:u.map(N=>e.jsxs(a,{value:String(N.id),children:[N.name," (",N.code,")"]},N.id))})]}),e.jsx(G,{})]})}),e.jsx(E,{control:i.control,name:"sensorId",render:({field:C})=>e.jsxs(V,{children:[e.jsx(R,{children:"Capteur"}),e.jsxs(I,{onValueChange:C.onChange,value:C.value,disabled:!ne,children:[e.jsx(B,{children:e.jsx(k,{children:e.jsx(_,{placeholder:"Sélectionner un capteur"})})}),e.jsx(L,{children:m.map(N=>e.jsxs(a,{value:String(N.id),children:[N.name," (",N.code,")"]},N.id))})]}),e.jsx(G,{})]})})]}),o&&e.jsx(p,{children:e.jsxs(f,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium",children:"Informations de l'équipement"}),o.niveau_sil&&o.niveau_sil!=="na"&&e.jsx(T,{variant:"destructive",children:pa[o.niveau_sil]||o.niveau_sil})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Type:"})," ",o.type]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Criticité:"})," ",o.criticite]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Système:"})," ",fa[o.type_systeme]||o.type_systeme||"Process"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Fabricant:"})," ",o.fabricant]})]}),o.fonction_securite&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Fonction sécurité:"})," ",o.fonction_securite]})]})}),D&&e.jsx(p,{children:e.jsxs(f,{className:"pt-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Informations du capteur"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Type:"})," ",D.type]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Unité:"})," ",D.unit]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Statut:"})," ",D.status]}),D.critical_threshold&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Seuil critique:"})," ",D.critical_threshold]})]})]})})]})}const wa=[{value:"preventive_maintenance",label:"Maintenance préventive"},{value:"corrective_maintenance",label:"Maintenance corrective"},{value:"calibration",label:"Étalonnage capteur"},{value:"testing",label:"Test de fonctionnement"},{value:"emergency_repair",label:"Réparation urgente"},{value:"system_upgrade",label:"Mise à niveau système"},{value:"investigation",label:"Investigation"},{value:"other",label:"Autre"}],va=[{value:"low",label:"Faible"},{value:"normal",label:"Normale"},{value:"high",label:"Élevée"},{value:"critical",label:"Critique"},{value:"emergency",label:"Urgence"}],Na=[{value:"very_low",label:"Très faible"},{value:"low",label:"Faible"},{value:"medium",label:"Moyen"},{value:"high",label:"Élevé"},{value:"very_high",label:"Très élevé"}],ya=[{id:"visual_inspection",label:"Inspection visuelle renforcée"},{id:"portable_detector",label:"Détecteur portable en place"},{id:"manual_monitoring",label:"Surveillance manuelle continue"},{id:"warning_signs",label:"Signalisation de sécurité"},{id:"restricted_access",label:"Accès restreint à la zone"},{id:"backup_system",label:"Système de secours activé"},{id:"fire_watch",label:"Ronde incendie"},{id:"emergency_plan",label:"Plan d'urgence communiqué"}];function ba({form:i,autoCalculatedCriticite:c,autoCalculatedDureeType:h}){return e.jsxs("div",{className:"space-y-6",children:[e.jsx(E,{control:i.control,name:"bypassType",render:({field:t})=>e.jsxs(V,{children:[e.jsx(R,{children:"Type de bypass"}),e.jsxs(I,{onValueChange:t.onChange,value:t.value,children:[e.jsx(B,{children:e.jsx(k,{children:e.jsx(_,{placeholder:"Sélectionner le type"})})}),e.jsx(L,{children:Object.entries(Ls).map(([d,u])=>e.jsx(a,{value:d,children:u},d))})]}),e.jsx(G,{})]})}),e.jsxs("div",{className:"flex gap-4 flex-wrap",children:[c&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Criticité:"}),e.jsx(T,{variant:c==="securite"?"destructive":"secondary",children:Ds[c]||c})]}),h&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Durée:"}),e.jsx(T,{variant:"outline",children:Ts[h]||h})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(E,{control:i.control,name:"reason",render:({field:t})=>e.jsxs(V,{children:[e.jsx(R,{children:"Raison du bypass"}),e.jsxs(I,{onValueChange:t.onChange,value:t.value,children:[e.jsx(B,{children:e.jsx(k,{children:e.jsx(_,{placeholder:"Sélectionner la raison"})})}),e.jsx(L,{children:wa.map(d=>e.jsx(a,{value:d.value,children:d.label},d.value))})]}),e.jsx(G,{})]})}),e.jsx(E,{control:i.control,name:"urgencyLevel",render:({field:t})=>e.jsxs(V,{children:[e.jsx(R,{children:"Niveau d'urgence"}),e.jsxs(I,{onValueChange:t.onChange,value:t.value,children:[e.jsx(B,{children:e.jsx(k,{children:e.jsx(_,{placeholder:"Sélectionner l'urgence"})})}),e.jsx(L,{children:va.map(d=>e.jsx(a,{value:d.value,children:d.label},d.value))})]}),e.jsx(G,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(E,{control:i.control,name:"plannedStartDate",render:({field:t})=>e.jsxs(V,{children:[e.jsx(R,{children:"Date de début prévue"}),e.jsx(B,{children:e.jsx(pe,{type:"datetime-local",...t})}),e.jsx(G,{})]})}),e.jsx(E,{control:i.control,name:"estimatedDuration",render:({field:t})=>e.jsxs(V,{children:[e.jsx(R,{children:"Durée estimée (heures)"}),e.jsx(B,{children:e.jsx(pe,{type:"number",min:1,max:168,...t})}),e.jsx(G,{})]})})]}),e.jsx(E,{control:i.control,name:"detailedJustification",render:({field:t})=>e.jsxs(V,{children:[e.jsx(R,{children:"Justification détaillée"}),e.jsx(B,{children:e.jsx(Ke,{rows:3,placeholder:"Décrivez en détail la raison du bypass...",...t})}),e.jsx(G,{})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:["safetyImpact","operationalImpact","environmentalImpact"].map(t=>e.jsx(E,{control:i.control,name:t,render:({field:d})=>e.jsxs(V,{children:[e.jsx(R,{children:t==="safetyImpact"?"Impact sécurité":t==="operationalImpact"?"Impact opérationnel":"Impact environnemental"}),e.jsxs(I,{onValueChange:d.onChange,value:d.value,children:[e.jsx(B,{children:e.jsx(k,{children:e.jsx(_,{placeholder:"Sélectionner"})})}),e.jsx(L,{children:Na.map(u=>e.jsx(a,{value:u.value,children:u.label},u.value))})]}),e.jsx(G,{})]})},t))}),e.jsx(E,{control:i.control,name:"mitigationMeasures",render:()=>e.jsxs(V,{children:[e.jsx(R,{children:"Mesures d'atténuation"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:ya.map(t=>e.jsx(E,{control:i.control,name:"mitigationMeasures",render:({field:d})=>e.jsxs(V,{className:"flex items-center space-x-2 space-y-0",children:[e.jsx(B,{children:e.jsx(ss,{checked:(d.value||[]).includes(t.id),onCheckedChange:u=>{const l=d.value||[];u?d.onChange([...l,t.id]):d.onChange(l.filter(m=>m!==t.id))}})}),e.jsx(R,{className:"text-sm font-normal cursor-pointer",children:t.label})]})},t.id))}),e.jsx(G,{})]})}),e.jsx(E,{control:i.control,name:"contingencyPlan",render:({field:t})=>e.jsxs(V,{children:[e.jsx(R,{children:"Plan de contingence (optionnel)"}),e.jsx(B,{children:e.jsx(Ke,{rows:2,placeholder:"Décrivez le plan de contingence...",...t})}),e.jsx(G,{})]})})]})}function Ca({form:i}){const[c,h]=x.useState(""),t=i.watch("oraMesuresCompensatoires")||[],d=()=>{c.trim()&&(i.setValue("oraMesuresCompensatoires",[...t,c.trim()]),h(""))},u=l=>{i.setValue("oraMesuresCompensatoires",t.filter((m,b)=>b!==l))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-lg border border-destructive/50 bg-destructive/5 p-4",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx(T,{variant:"destructive",children:"ORA Requise"})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Cet équipement est classé comme système de sécurité (SIL). Une Operational Risk Assessment (ORA) est obligatoire avant approbation."})]}),e.jsx(E,{control:i.control,name:"oraDangersIdentifies",render:({field:l})=>e.jsxs(V,{children:[e.jsx(R,{children:"Dangers identifiés"}),e.jsx(B,{children:e.jsx(Ke,{rows:4,placeholder:"Décrivez les dangers identifiés suite à la mise en bypass de ce système de sécurité...",...l})}),e.jsx(G,{})]})}),e.jsxs("div",{children:[e.jsx(R,{children:"Mesures compensatoires"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(pe,{value:c,onChange:l=>h(l.target.value),placeholder:"Ajouter une mesure compensatoire",onKeyDown:l=>{l.key==="Enter"&&(l.preventDefault(),d())}}),e.jsx($,{type:"button",size:"icon",onClick:d,children:e.jsx(na,{className:"h-4 w-4"})})]}),t.length>0&&e.jsx("ul",{className:"mt-3 space-y-2",children:t.map((l,m)=>e.jsxs("li",{className:"flex items-center gap-2 text-sm bg-muted p-2 rounded",children:[e.jsx("span",{className:"flex-1",children:l}),e.jsx($,{type:"button",variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>u(m),children:e.jsx(Gs,{className:"h-3 w-3"})})]},m))}),t.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Au moins une mesure compensatoire est requise."})]}),e.jsx(E,{control:i.control,name:"oraIplAffectees",render:({field:l})=>e.jsxs(V,{children:[e.jsx(R,{children:"IPL affectées (optionnel)"}),e.jsx(B,{children:e.jsx(Ke,{rows:2,placeholder:"Listez les Independent Protection Layers affectées...",...l})}),e.jsx(G,{})]})})]})}const Sa={preventive_maintenance:"Maintenance préventive",corrective_maintenance:"Maintenance corrective",calibration:"Étalonnage capteur",testing:"Test de fonctionnement",emergency_repair:"Réparation urgente",system_upgrade:"Mise à niveau système",investigation:"Investigation",other:"Autre"},es={very_low:"Très faible",low:"Faible",medium:"Moyen",high:"Élevé",very_high:"Très élevé"},Aa={low:"Faible",normal:"Normale",high:"Élevée",critical:"Critique",emergency:"Urgence"};function Ia({form:i,equipmentName:c,sensorName:h,siteName:t,zoneName:d,showOra:u}){var m,b;const l=i.getValues();return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(p,{children:[e.jsx(P,{className:"pb-2",children:e.jsx(M,{className:"text-base",children:"Équipement & Localisation"})}),e.jsxs(f,{className:"text-sm space-y-1",children:[t&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Site:"})," ",t]}),d&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Zone:"})," ",d]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Équipement:"})," ",c||l.equipmentId]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Capteur:"})," ",h||l.sensorId]})]})]}),e.jsxs(p,{children:[e.jsx(P,{className:"pb-2",children:e.jsx(M,{className:"text-base",children:"Détails du bypass"})}),e.jsxs(f,{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[l.bypassType&&e.jsx(T,{variant:"outline",children:Ls[l.bypassType]||l.bypassType}),l.criticite&&e.jsx(T,{variant:l.criticite==="securite"?"destructive":"secondary",children:Ds[l.criticite]||l.criticite}),l.dureeType&&e.jsx(T,{variant:"outline",children:Ts[l.dureeType]||l.dureeType})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Raison:"})," ",Sa[l.reason]||l.reason]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Urgence:"})," ",Aa[l.urgencyLevel]||l.urgencyLevel]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Début:"})," ",l.plannedStartDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Durée:"})," ",l.estimatedDuration,"h"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Justification:"})," ",l.detailedJustification]})]})]}),e.jsxs(p,{children:[e.jsx(P,{className:"pb-2",children:e.jsx(M,{className:"text-base",children:"Impacts & Mesures"})}),e.jsxs(f,{className:"text-sm space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Sécurité:"})," ",es[l.safetyImpact]||l.safetyImpact]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Opérationnel:"})," ",es[l.operationalImpact]||l.operationalImpact]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Environnemental:"})," ",es[l.environmentalImpact]||l.environmentalImpact]}),((m=l.mitigationMeasures)==null?void 0:m.length)>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Mesures d'atténuation:"}),e.jsx("ul",{className:"list-disc list-inside mt-1",children:l.mitigationMeasures.map((o,w)=>e.jsx("li",{children:o},w))})]}),l.contingencyPlan&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Plan de contingence:"})," ",l.contingencyPlan]})]})]}),u&&l.oraDangersIdentifies&&e.jsxs(p,{children:[e.jsx(P,{className:"pb-2",children:e.jsxs(M,{className:"text-base flex items-center gap-2",children:["ORA ",e.jsx(T,{variant:"destructive",children:"Sécurité"})]})}),e.jsxs(f,{className:"text-sm space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Dangers:"})," ",l.oraDangersIdentifies]}),((b=l.oraMesuresCompensatoires)==null?void 0:b.length)>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Mesures compensatoires:"}),e.jsx("ul",{className:"list-disc list-inside mt-1",children:l.oraMesuresCompensatoires.map((o,w)=>e.jsx("li",{children:o},w))})]}),l.oraIplAffectees&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"IPL affectées:"})," ",l.oraIplAffectees]})]})]}),e.jsxs(p,{children:[e.jsx(P,{className:"pb-2",children:e.jsx(M,{className:"text-base",children:"Engagements de sécurité"})}),e.jsxs(f,{className:"space-y-3",children:[e.jsx(E,{control:i.control,name:"safetyAck1",render:({field:o})=>e.jsxs(V,{className:"flex items-start space-x-2 space-y-0",children:[e.jsx(B,{children:e.jsx(ss,{checked:o.value,onCheckedChange:o.onChange})}),e.jsx(R,{className:"text-sm font-normal",children:"Je confirme que les mesures de sécurité compensatoires sont en place"})]})}),e.jsx(E,{control:i.control,name:"safetyAck2",render:({field:o})=>e.jsxs(V,{className:"flex items-start space-x-2 space-y-0",children:[e.jsx(B,{children:e.jsx(ss,{checked:o.value,onCheckedChange:o.onChange})}),e.jsx(R,{className:"text-sm font-normal",children:"Je m'engage à restaurer le bypass dès la fin des travaux"})]})})]})]})]})}const ka=sa({siteId:K().min(1,"Veuillez sélectionner un site"),zoneId:K().min(1,"Veuillez sélectionner une zone"),equipmentId:K().min(1,"Veuillez sélectionner un équipement"),sensorId:K().min(1,"Veuillez sélectionner un capteur"),bypassType:be(["maintenance","operationnel","permissif"]),reason:be(["preventive_maintenance","corrective_maintenance","calibration","testing","emergency_repair","system_upgrade","investigation","other"]),urgencyLevel:be(["low","normal","high","critical","emergency"]),plannedStartDate:K().min(1,"Date de début requise"),estimatedDuration:K().min(1,"Durée requise"),detailedJustification:K().min(20,"Justification minimale: 20 caractères"),safetyImpact:be(["very_low","low","medium","high","very_high"]),operationalImpact:be(["very_low","low","medium","high","very_high"]),environmentalImpact:be(["very_low","low","medium","high","very_high"]),mitigationMeasures:os(K()).min(1,"Au moins une mesure d'atténuation requise"),contingencyPlan:K().optional(),oraDangersIdentifies:K().optional(),oraMesuresCompensatoires:os(K()).optional(),oraIplAffectees:K().optional(),safetyAck1:xs().refine(i=>i===!0,"Requis"),safetyAck2:xs().refine(i=>i===!0,"Requis"),criticite:K().optional(),dureeType:K().optional()}),_a=()=>{const i=Ys();js();const[c,h]=x.useState(1),[t,d]=x.useState(!1),[u,l]=x.useState(null),m=aa({resolver:ta(ka),defaultValues:{siteId:"",zoneId:"",equipmentId:"",sensorId:"",bypassType:void 0,reason:void 0,urgencyLevel:void 0,plannedStartDate:"",estimatedDuration:"",detailedJustification:"",safetyImpact:void 0,operationalImpact:void 0,environmentalImpact:void 0,mitigationMeasures:[],contingencyPlan:"",oraDangersIdentifies:"",oraMesuresCompensatoires:[],oraIplAffectees:"",safetyAck1:!1,safetyAck2:!1,criticite:"",dureeType:""}}),b=m.watch("equipmentId"),o=m.watch("estimatedDuration");x.useEffect(()=>{b&&te.get(`/equipment/${b}`).then(g=>{const Y=g.data.data||g.data;l(Y);const q=Y.is_security_equipment?"securite":"process";m.setValue("criticite",q)}).catch(console.error)},[b]),x.useEffect(()=>{const g=parseInt(String(o));!isNaN(g)&&g>0&&m.setValue("dureeType",g<48?"court_terme":"long_terme")},[o]);const w=m.watch("criticite"),D=m.watch("dureeType"),F=w==="securite",le=x.useMemo(()=>{const g=[{id:1,title:"Équipement"},{id:2,title:"Détails"}];return F?(g.push({id:3,title:"ORA"}),g.push({id:4,title:"Récapitulatif"})):g.push({id:3,title:"Récapitulatif"}),g},[F]),X=le.length,ne=F?4:3,re=async()=>{let g=[];if(c===1)g=["siteId","zoneId","equipmentId","sensorId"];else if(c===2)g=["bypassType","reason","urgencyLevel","plannedStartDate","estimatedDuration","detailedJustification","safetyImpact","operationalImpact","environmentalImpact","mitigationMeasures"];else if(c===3&&F){const Y=m.getValues("oraDangersIdentifies"),q=m.getValues("oraMesuresCompensatoires");return!Y||Y.trim().length===0?(m.setError("oraDangersIdentifies",{message:"Les dangers doivent être identifiés"}),!1):!q||q.length===0?(Xe.error("Au moins une mesure compensatoire est requise"),!1):!0}return g.length>0?await m.trigger(g):!0},C=async()=>{await re()&&h(Y=>Math.min(Y+1,X))},N=()=>{h(g=>Math.max(g-1,1))},_e=async g=>{var Y,q,Le;if(!(!g&&!await m.trigger(["safetyAck1","safetyAck2"]))){d(!0);try{const A=m.getValues(),Se={reason:A.reason,detailedJustification:A.detailedJustification,urgencyLevel:A.urgencyLevel,equipmentId:parseInt(A.equipmentId),sensorId:parseInt(A.sensorId),plannedStartDate:A.plannedStartDate,estimatedDuration:parseInt(A.estimatedDuration),safetyImpact:A.safetyImpact,operationalImpact:A.operationalImpact,environmentalImpact:A.environmentalImpact,mitigationMeasures:A.mitigationMeasures,contingencyPlan:A.contingencyPlan||void 0,bypassType:A.bypassType,isDraft:g},fe=await te.post("/requests",Se);if(F&&A.oraDangersIdentifies&&!g){const S=((Y=fe.data.data)==null?void 0:Y.id)||fe.data.id;await te.post(`/requests/${S}/ora`,{dangers_identifies:A.oraDangersIdentifies,mesures_compensatoires:A.oraMesuresCompensatoires,ipl_affectees:A.oraIplAffectees||void 0})}Xe.success(g?"Brouillon sauvegardé":"Demande de bypass soumise avec succès"),i("/requests")}catch(A){const Se=((Le=(q=A.response)==null?void 0:q.data)==null?void 0:Le.message)||"Erreur lors de la soumission";Xe.error(Se)}finally{d(!1)}}};return e.jsxs(p,{children:[e.jsx(P,{children:e.jsx(M,{children:"Nouvelle demande de bypass"})}),e.jsxs(f,{children:[e.jsx(ja,{steps:le,currentStep:c,onStepClick:g=>{g<c&&h(g)}}),e.jsx(la,{...m,children:e.jsxs("form",{onSubmit:g=>g.preventDefault(),className:"space-y-6",children:[c===1&&e.jsx(ga,{form:m}),c===2&&e.jsx(ba,{form:m,autoCalculatedCriticite:w,autoCalculatedDureeType:D}),c===3&&F&&e.jsx(Ca,{form:m}),c===ne&&e.jsx(Ia,{form:m,equipmentName:u==null?void 0:u.name,sensorName:void 0,showOra:F}),e.jsxs("div",{className:"flex justify-between pt-4 border-t",children:[e.jsxs($,{type:"button",variant:"outline",onClick:N,disabled:c===1,children:[e.jsx(as,{className:"mr-2 h-4 w-4"}),"Précédent"]}),e.jsxs("div",{className:"flex gap-2",children:[c===ne&&e.jsxs(e.Fragment,{children:[e.jsxs($,{type:"button",variant:"outline",onClick:()=>_e(!0),disabled:t,children:[t?e.jsx(ds,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(ia,{className:"mr-2 h-4 w-4"}),"Sauvegarder brouillon"]}),e.jsxs($,{type:"button",onClick:()=>_e(!1),disabled:t,children:[t?e.jsx(ds,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(ma,{className:"mr-2 h-4 w-4"}),"Soumettre"]})]}),c<X&&e.jsxs($,{type:"button",onClick:C,children:["Suivant",e.jsx(da,{className:"ml-2 h-4 w-4"})]})]})]})]})})]})]})};function et(){const i=Us(),[c,h]=x.useState(""),[t,d]=x.useState("all"),[u,l]=x.useState("all"),[m,b]=x.useState("all"),[o,w]=x.useState(void 0),[D,F]=x.useState([]),[le,X]=x.useState([]),[ne,re]=x.useState([]),[C,N]=x.useState([]),[_e,g]=x.useState(!1),[Y,q]=x.useState(!0),[Le,A]=x.useState(!1),[Se,fe]=x.useState(!1),{user:S}=js(),[y,Z]=x.useState(1),[J,De]=x.useState(3),[z,Ps]=x.useState(((S==null?void 0:S.role)!=="user","mine")),Te=()=>{switch(z){case"all":return _e;case"mine":return Y;case"pending":return Le;case"active":return Se;default:return Y}},Fs=i.pathname==="/requests/new",Ms=s=>{const r=new Date,j=new Date(r.getFullYear(),r.getMonth(),r.getDate());switch(s){case"today":return{start:j,end:new Date(j.getTime()+24*60*60*1e3-1)};case"week":const v=new Date(j),ie=j.getDay(),W=ie===0?6:ie-1;v.setDate(j.getDate()-W),v.setHours(0,0,0,0);const H=new Date(v);return H.setDate(v.getDate()+6),H.setHours(23,59,59,999),{start:v,end:H};case"month":const is=new Date(r.getFullYear(),r.getMonth(),1);is.setHours(0,0,0,0);const Rs=new Date(r.getFullYear(),r.getMonth()+1,0,23,59,59,999);return{start:is,end:Rs};case"custom":if(o){const rs=new Date(o);rs.setHours(0,0,0,0);const cs=new Date(o);return cs.setHours(23,59,59,999),{start:rs,end:cs}}return null;default:return null}},Pe=s=>{if(m==="all")return!0;const r=Ms(m);if(r&&s.created_at){const j=new Date(s.created_at);return j>=r.start&&j<=r.end}else if(m==="custom"&&!o)return!0;return!1},ge=(D??[]).filter(s=>{var W,H;const r=(((W=s.equipment)==null?void 0:W.name)||"").toLowerCase().includes(c.toLowerCase())||(((H=s.sensor)==null?void 0:H.name)||"").toLowerCase().includes(c.toLowerCase())||(s.request_code||"").toLowerCase().includes(c.toLowerCase()),j=t==="all"||s.status===t,v=u==="all"||s.priority===u,ie=Pe(s);return r&&j&&v&&ie}),de=(le??[]).filter(s=>{var W,H;const r=(((W=s.equipment)==null?void 0:W.name)||"").toLowerCase().includes(c.toLowerCase())||(((H=s.sensor)==null?void 0:H.name)||"").toLowerCase().includes(c.toLowerCase())||(s.request_code||"").toLowerCase().includes(c.toLowerCase()),j=t==="all"||s.status===t,v=u==="all"||s.priority===u,ie=Pe(s);return r&&j&&v&&ie}),we=(ne??[]).filter(s=>{var W,H;const r=(((W=s.equipment)==null?void 0:W.name)||"").toLowerCase().includes(c.toLowerCase())||(((H=s.sensor)==null?void 0:H.name)||"").toLowerCase().includes(c.toLowerCase())||(s.request_code||"").toLowerCase().includes(c.toLowerCase()),j=t==="all"||s.status===t,v=u==="all"||s.priority===u,ie=Pe(s);return r&&j&&v&&ie}),ve=(C??[]).filter(s=>{var W,H;const r=(((W=s.equipment)==null?void 0:W.name)||"").toLowerCase().includes(c.toLowerCase())||(((H=s.sensor)==null?void 0:H.name)||"").toLowerCase().includes(c.toLowerCase())||(s.request_code||"").toLowerCase().includes(c.toLowerCase()),j=t==="all"||s.status===t,v=u==="all"||s.priority===u,ie=Pe(s);return r&&j&&v&&ie}),ns=(()=>{switch(z){case"all":return ge;case"mine":return de;case"pending":return we;case"active":return ve;default:return de}})(),O=Math.ceil(ns.length/J),Ne=(y-1)*J,Ae=Ne+J,ee=ns.slice(Ne,Ae);x.useEffect(()=>{Z(1)},[c,t,u,m,o,z,J]),x.useEffect(()=>{m!=="custom"&&w(void 0)},[m]),x.useEffect(()=>{S&&["administrateur","administrator"].includes(S.role)&&(g(!0),te.get("/requests").then(s=>{Array.isArray(s.data)?F(s.data):s.data&&s.data.data&&Array.isArray(s.data.data)?F(s.data.data):F([]),g(!1)}).catch(s=>{console.error("Error fetching data:",s),g(!1)})),S&&["administrateur","administrator","chef_de_quart","supervisor","responsable_hse","resp_exploitation","directeur","director"].includes(S.role)&&(A(!0),te.get("/requests/pending").then(s=>{Array.isArray(s.data)?re(s.data):s.data&&s.data.data&&Array.isArray(s.data.data)?re(s.data.data):re([]),A(!1)}).catch(s=>{console.error("Error fetching data:",s),A(!1)}),fe(!0),te.get("/requests/active").then(s=>{Array.isArray(s.data)?N(s.data):s.data&&s.data.data&&Array.isArray(s.data.data)?N(s.data.data):N([]),fe(!1)}).catch(s=>{console.error("Error fetching data:",s),fe(!1)})),q(!0),te.get("/requests/mine").then(s=>{Array.isArray(s.data)?X(s.data):s.data&&s.data.data&&Array.isArray(s.data.data)?X(s.data.data):X([]),q(!1)}).catch(s=>{console.error("Error fetching data:",s),X([]),q(!1)})},[i.key]);const me=s=>{switch(s){case"Haute":return"bg-destructive text-destructive-foreground";case"high":return"bg-destructive text-destructive-foreground";case"Moyenne":return"bg-warning text-warning-foreground";case"medium":return"bg-warning text-warning-foreground";case"Faible":return"bg-success text-success-foreground";case"low":return"bg-success text-success-foreground";default:return"bg-muted text-muted-foreground"}},oe=s=>{switch(s){case"draft":return"bg-muted text-muted-foreground";case"pending":return"bg-warning text-warning-foreground";case"approved":return"bg-blue-500 text-white";case"active":return"bg-green-600 text-white";case"closed":return"bg-gray-600 text-white";case"expired":return"bg-orange-500 text-white";case"rejected":return"bg-destructive text-destructive-foreground";default:return"bg-muted text-muted-foreground"}},se=s=>{switch(s){case"draft":return e.jsx(ae,{className:"w-5 h-5 sm:w-6 sm:h-6"});case"pending":return e.jsx(ca,{className:"w-5 h-5 sm:w-6 sm:h-6"});case"approved":return e.jsx(Ce,{className:"w-5 h-5 sm:w-6 sm:h-6"});case"active":return e.jsx(ra,{className:"w-5 h-5 sm:w-6 sm:h-6"});case"closed":return e.jsx(Ce,{className:"w-5 h-5 sm:w-6 sm:h-6"});case"expired":return e.jsx(Zs,{className:"w-5 h-5 sm:w-6 sm:h-6"});case"rejected":return e.jsx(Ks,{className:"w-5 h-5 sm:w-6 sm:h-6"});default:return e.jsx(ae,{className:"w-5 h-5 sm:w-6 sm:h-6"})}},Fe=()=>{h(""),d("all"),l("all"),b("all"),w(void 0)};return Fs?e.jsxs("div",{className:"flex-1 space-y-3 sm:space-y-4 md:space-y-6 p-3 sm:p-4 md:p-6",children:[e.jsx("div",{className:"w-full max-w-4xl mx-auto",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{className:"text-left w-full sm:w-auto",children:[e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold tracking-tight",children:"Nouvelle demande de bypass"}),e.jsx("p",{className:"text-xs sm:text-sm md:text-base text-muted-foreground mt-1",children:"Créer une nouvelle demande de bypass de capteur"})]}),e.jsx($,{variant:"outline",size:"icon",asChild:!0,className:"flex-shrink-0 rounded-full w-12 h-12",children:e.jsx(Qe,{to:"/requests",children:e.jsx(as,{className:"w-5 h-5"})})})]})}),e.jsx(_a,{})]}):e.jsxs("div",{className:"w-full p-3 sm:p-4 md:p-6 space-y-4 sm:space-y-6 overflow-x-hidden box-border",children:[e.jsx(p,{className:"bg-card rounded-lg border",children:e.jsx(f,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[e.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-full bg-blue-600 flex items-center justify-center",children:e.jsx(ae,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-foreground break-words mb-1",children:"Gestion des demandes"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground break-words mb-2",children:"Suivi et gestion des demandes de bypass"}),e.jsx(Ws,{children:e.jsxs(Xs,{children:[e.jsx(ms,{children:e.jsx(Qs,{asChild:!0,children:e.jsx(Qe,{to:"/",children:"Tableau de bord"})})}),e.jsx(qs,{}),e.jsx(ms,{children:e.jsx(ea,{children:"Demandes"})})]})})]})]}),e.jsx($,{variant:"outline",size:"icon",className:"flex-shrink-0 rounded-full w-10 h-10",asChild:!0,children:e.jsx(Qe,{to:"/",children:e.jsx(as,{className:"w-4 h-4"})})})]})})}),e.jsxs(ua,{value:z,onValueChange:Ps,className:"w-full min-w-0",children:[e.jsxs(_s,{className:"flex flex-row w-full h-auto gap-2 flex-wrap justify-between",children:[(S==null?void 0:S.role)==="administrator"&&e.jsx(Ie,{value:"all",onClick:Fe,className:"text-xs sm:text-sm py-2 px-2 sm:px-4 truncate flex-1 min-w-0",children:"Toutes les demandes"}),e.jsx(Ie,{value:"mine",onClick:Fe,className:"text-xs sm:text-sm py-2 px-2 sm:px-4 truncate flex-1 min-w-0",children:"Mes demandes"}),((S==null?void 0:S.role)==="administrator"||(S==null?void 0:S.role)==="supervisor")&&e.jsxs(e.Fragment,{children:[e.jsx(Ie,{value:"pending",onClick:Fe,className:"text-xs sm:text-sm py-2 px-2 sm:px-4 truncate flex-1 min-w-0",children:e.jsx("span",{className:"truncate",children:"En attente"})}),e.jsx(Ie,{value:"active",onClick:Fe,className:"text-xs sm:text-sm py-2 px-2 sm:px-4 truncate flex-1 min-w-0",children:"Bypass actifs"})]})]}),(S==null?void 0:S.role)==="administrator"&&e.jsxs(ke,{value:"all",className:"space-y-4 sm:space-y-6",children:[e.jsx(p,{className:"w-full box-border",children:e.jsxs(f,{className:"p-4 sm:p-6 w-full min-w-0",children:[e.jsxs("div",{className:"grid gap-3 grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 w-full min-w-0",children:[e.jsxs("div",{className:"relative sm:col-span-2 lg:col-span-1 w-full min-w-0",children:[e.jsx(Me,{className:"absolute left-2 top-2.5 h-3.5 w-3.5 sm:h-4 sm:w-4 text-muted-foreground"}),e.jsx(pe,{placeholder:"Rechercher...",value:c,onChange:s=>h(s.target.value),className:"pl-8 sm:pl-10 w-full text-sm"})]}),e.jsxs(I,{value:t,onValueChange:d,children:[e.jsx(k,{className:"text-sm w-full min-w-0",children:e.jsx(_,{placeholder:"Statut"})}),e.jsxs(L,{children:[e.jsx(a,{value:"all",children:"Tous les statuts"}),e.jsx(a,{value:"draft",children:"Brouillon"}),e.jsx(a,{value:"pending",children:"En attente"}),e.jsx(a,{value:"approved",children:"Approuvé"}),e.jsx(a,{value:"active",children:"Actif"}),e.jsx(a,{value:"closed",children:"Clôturé"}),e.jsx(a,{value:"expired",children:"Expiré"}),e.jsx(a,{value:"rejected",children:"Rejeté"})]})]}),e.jsxs(I,{value:u,onValueChange:l,children:[e.jsx(k,{className:"text-sm w-full min-w-0",children:e.jsx(_,{placeholder:"Priorité"})}),e.jsxs(L,{children:[e.jsx(a,{value:"all",children:"Toutes les priorités"}),e.jsx(a,{value:"high",children:"Haute"}),e.jsx(a,{value:"medium",children:"Moyenne"}),e.jsx(a,{value:"low",children:"Faible"})]})]}),e.jsxs(I,{value:m,onValueChange:b,children:[e.jsx(k,{className:"text-sm w-full min-w-0",children:e.jsx(_,{placeholder:"Période"})}),e.jsxs(L,{children:[e.jsx(a,{value:"all",children:"Toutes les périodes"}),e.jsx(a,{value:"today",children:"Aujourd'hui"}),e.jsx(a,{value:"week",children:"Cette semaine"}),e.jsx(a,{value:"month",children:"Ce mois"}),e.jsx(a,{value:"custom",children:"Personnalisée"})]})]}),e.jsxs($,{variant:"outline",onClick:()=>{h(""),d("all"),l("all"),b("all"),w(void 0)},className:"text-sm w-full sm:w-auto min-w-0 truncate",children:[e.jsx("span",{className:"hidden sm:inline truncate",children:"Réinitialiser filtres"}),e.jsx("span",{className:"sm:hidden truncate",children:"Réinitialiser"})]})]}),m==="custom"&&e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs("div",{className:"space-y-2 max-w-xs",children:[e.jsx(ce,{className:"text-sm",children:"Sélectionner une date"}),e.jsxs(Oe,{children:[e.jsx($e,{asChild:!0,children:e.jsxs($,{variant:"outline",className:`w-full justify-start text-left font-normal text-sm ${!o&&"text-muted-foreground"}`,children:[e.jsx(Ue,{className:"mr-2 h-4 w-4"}),o?Je(o,"PPP",{locale:Ye}):e.jsx("span",{children:"Sélectionner une date"})]})}),e.jsx(He,{className:"w-auto p-0",align:"start",children:e.jsx(Ge,{mode:"single",selected:o,onSelect:w,initialFocus:!0})})]})]})})]})}),ge.length>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-stretch sm:items-center gap-3 sm:gap-4 mt-3 sm:mt-4 w-full min-w-0",children:[e.jsx("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-3 min-w-0 flex-wrap",children:e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(ce,{htmlFor:"items-per-page",className:"text-xs sm:text-sm whitespace-nowrap flex-shrink-0",children:"Éléments par page:"}),e.jsxs(I,{value:J.toString(),onValueChange:s=>De(Number(s)),children:[e.jsx(k,{className:"w-16 sm:w-20 flex-shrink-0 h-8 text-xs sm:text-sm",children:e.jsx(_,{})}),e.jsxs(L,{children:[e.jsx(a,{value:"3",children:"3"}),e.jsx(a,{value:"6",children:"6"}),e.jsx(a,{value:"9",children:"9"}),e.jsx(a,{value:"12",children:"12"}),e.jsx(a,{value:"15",children:"15"})]})]})]})}),e.jsxs("div",{className:"text-xs text-muted-foreground text-left",children:["Affichage de ",Ne+1," à ",Math.min(Ae,ge.length)," sur ",ge.length," demande",ge.length>1?"s":""]})]}),Te()?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:hidden gap-3 sm:gap-3 md:gap-4 w-full min-w-0",children:Array.from({length:J}).map((s,r)=>e.jsxs(p,{className:"flex flex-col h-full w-full min-w-0 box-border",children:[e.jsxs(P,{className:"pb-4 p-6 min-w-0",children:[e.jsx("div",{className:"flex items-start justify-between gap-1.5 min-w-0",children:e.jsxs("div",{className:"flex items-center gap-1.5 min-w-0 flex-1",children:[e.jsx(n,{className:"w-6 h-6 rounded-full"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx(n,{className:"h-5 w-32 mb-2"}),e.jsx(n,{className:"h-4 w-24"})]})]})}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-3 flex-wrap",children:[e.jsx(n,{className:"h-5 w-16"}),e.jsx(n,{className:"h-5 w-20"})]})]}),e.jsxs(f,{className:"space-y-1.5 p-6 pt-0 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"h-3 w-20"}),e.jsx(n,{className:"h-3 w-24"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"h-3 w-12"}),e.jsx(n,{className:"h-3 w-28"})]}),e.jsx(n,{className:"h-3 w-full mt-2"}),e.jsx(n,{className:"h-8 w-24 mt-2"})]})]},r))}),e.jsx("div",{className:"hidden lg:block space-y-3 sm:space-y-4 md:space-y-6 w-full min-w-0",children:Array.from({length:J}).map((s,r)=>e.jsxs(p,{className:"w-full min-w-0 box-border",children:[e.jsx(P,{className:"p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[e.jsx(n,{className:"w-8 h-8 rounded-full"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx(n,{className:"h-4 w-32 mb-2"}),e.jsx(n,{className:"h-3 w-48"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx(n,{className:"h-5 w-16"}),e.jsx(n,{className:"h-5 w-20"})]})]})}),e.jsxs(f,{className:"p-3 sm:p-4 pt-0 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[e.jsx(n,{className:"h-3 w-20"}),e.jsx(n,{className:"h-3 w-32"})]}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(n,{className:"h-3 w-12"}),e.jsx(n,{className:"h-3 w-36"})]})]}),e.jsx(n,{className:"h-3 w-full mt-3 pt-3"}),e.jsx(n,{className:"h-8 w-28 mt-3"})]})]},r))})]}):z==="all"&&ee.length===0?e.jsx(p,{className:"w-full box-border",children:e.jsxs(f,{className:"text-center py-6 sm:py-8",children:[e.jsx(ae,{className:"w-10 h-10 sm:w-12 sm:h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Aucune demande trouvée."})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:hidden gap-3 sm:gap-3 md:gap-4 w-full min-w-0",children:z==="all"&&ee.map(s=>{var r,j,v;return e.jsxs(p,{className:"hover:shadow-lg transition-shadow flex flex-col h-full w-full min-w-0 box-border",children:[e.jsxs(P,{className:"pb-4 p-6 min-w-0",children:[e.jsx("div",{className:"flex items-start justify-between gap-1.5 min-w-0",children:e.jsxs("div",{className:"flex items-center gap-1.5 min-w-0 flex-1",children:[e.jsx("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-primary/10 flex-shrink-0",children:se(s.status)}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx(M,{className:"text-lg truncate min-w-0",children:s.request_code}),e.jsxs(ye,{className:"text-xs line-clamp-2 mt-1.5 min-w-0",children:[((r=s.equipment)==null?void 0:r.name)||"N/A"," - ",((j=s.sensor)==null?void 0:j.name)||"N/A"]})]})]})}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-3 flex-wrap",children:[e.jsx(T,{variant:"outline",className:me(s.priority)+" text-xs whitespace-nowrap flex-shrink-0",children:U(xe,s.priority)}),e.jsx(T,{className:oe(s.status)+" text-xs whitespace-nowrap flex-shrink-0",children:U(he,s.status)})]})]}),e.jsxs(f,{className:"space-y-1.5 p-6 pt-0 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between min-w-0",children:[e.jsx("span",{className:"text-xs text-muted-foreground truncate",children:"Demandeur:"}),e.jsx("span",{className:"text-xs truncate",children:((v=s.requester)==null?void 0:v.full_name)||"N/A"})]}),e.jsxs("div",{className:"flex items-center justify-between min-w-0",children:[e.jsx("span",{className:"text-xs text-muted-foreground truncate",children:"Date:"}),e.jsx("span",{className:"text-xs truncate whitespace-nowrap",children:new Date(s.created_at).toLocaleString("fr-FR",{dateStyle:"short",timeStyle:"short"})})]}),s.description&&e.jsx("div",{className:"pt-1",children:e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2 min-w-0",children:s.description})}),e.jsx("div",{className:"pt-2",children:e.jsx(ue,{request:s})})]})]},s.id)})}),e.jsx("div",{className:"hidden lg:block space-y-3 sm:space-y-4 md:space-y-6 w-full min-w-0",children:z==="all"&&ee.map(s=>{var r,j,v;return e.jsx(p,{className:"hover:shadow-lg transition-shadow w-full min-w-0 box-border",children:e.jsx(f,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 sm:gap-6 items-start sm:items-center",children:[e.jsxs("div",{className:"flex items-start gap-3 sm:gap-4 flex-shrink-0",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-primary/15 flex-shrink-0",children:e.jsx("div",{className:"text-blue-600",children:s.status==="Approuvé"||s.status==="approved"?e.jsx(Ce,{className:"w-5 h-5 sm:w-6 sm:h-6"}):se(s.status)?e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 flex items-center justify-center",children:se(s.status)}):e.jsx(ae,{className:"w-5 h-5 sm:w-6 sm:h-6"})})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-wrap mb-2",children:[e.jsx(M,{className:"text-base sm:text-lg font-bold truncate min-w-0",children:s.request_code}),e.jsx(T,{variant:"outline",className:me(s.priority)+" text-xs whitespace-nowrap flex-shrink-0",children:U(xe,s.priority)}),e.jsx(T,{className:oe(s.status)+" text-xs whitespace-nowrap flex-shrink-0",children:U(he,s.status)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:((r=s.equipment)==null?void 0:r.name)||"N/A"}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:((j=s.sensor)==null?void 0:j.name)||"N/A"})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:gap-3 flex-1 min-w-0 items-center sm:items-center",children:[e.jsx("p",{className:"text-sm font-semibold text-center truncate",children:((v=s.requester)==null?void 0:v.full_name)||"N/A"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground text-center whitespace-nowrap",children:new Date(s.created_at).toLocaleString("fr-FR",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}),s.description&&e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground text-center line-clamp-2 max-w-[300px]",children:s.description})]}),e.jsx("div",{className:"flex flex-col gap-2 sm:gap-3 flex-shrink-0 w-full sm:w-auto items-center sm:items-center",children:e.jsx("div",{className:"mt-2 flex justify-end",children:e.jsx(ue,{request:s})})})]})})},s.id)})})]}),ge.length>0&&O>1&&e.jsx("div",{className:"flex justify-center sm:justify-end items-center mt-4 sm:mt-6 w-full min-w-0 overflow-x-hidden",children:e.jsx(Re,{children:e.jsxs(Ee,{className:"flex-wrap min-w-0",children:[e.jsx(Q,{children:e.jsx(Ve,{href:"#",onClick:s=>{s.preventDefault(),y>1&&Z(y-1)},className:y===1?"pointer-events-none opacity-50":"cursor-pointer"})}),Array.from({length:O},(s,r)=>r+1).map(s=>e.jsx(Q,{children:e.jsx(Be,{href:"#",onClick:r=>{r.preventDefault(),Z(s)},isActive:y===s,className:"cursor-pointer",children:s})},s)),e.jsx(Q,{children:e.jsx(ze,{href:"#",onClick:s=>{s.preventDefault(),y<O&&Z(y+1)},className:y===O?"pointer-events-none opacity-50":"cursor-pointer"})})]})})})]}),e.jsx(ke,{value:"mine",className:"space-y-4 sm:space-y-6",children:le.length===0?e.jsxs(p,{className:"w-full box-border",children:[e.jsxs(P,{className:"p-3 sm:p-4",children:[e.jsx(M,{className:"text-sm sm:text-base",children:"Mes demandes"}),e.jsx(ye,{className:"text-xs sm:text-sm",children:"Vos demandes de bypass"})]}),e.jsx(f,{className:"p-3 sm:p-4 pt-0",children:e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground text-center py-6 sm:py-8",children:"Aucune demande."})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(p,{className:"w-full box-border",children:[e.jsx(P,{className:"p-3 sm:p-4",children:e.jsxs(M,{className:"flex items-center gap-2 text-sm sm:text-base",children:[e.jsx(qe,{className:"w-4 h-4 sm:w-4 sm:h-4"}),"Filtres"]})}),e.jsxs(f,{className:"p-3 sm:p-4 pt-0 w-full min-w-0",children:[e.jsxs("div",{className:"grid gap-3 sm:gap-3 md:gap-4 lg:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 w-full min-w-0",children:[e.jsxs("div",{className:"relative sm:col-span-2 lg:col-span-1 w-full min-w-0",children:[e.jsx(Me,{className:"absolute left-2 sm:left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 sm:w-4 sm:h-4 text-muted-foreground"}),e.jsx(pe,{placeholder:"Rechercher...",value:c,onChange:s=>h(s.target.value),className:"pl-8 sm:pl-10 text-sm w-full"})]}),e.jsxs(I,{value:t,onValueChange:d,children:[e.jsx(k,{className:"text-sm h-9 sm:h-10 w-full min-w-0",children:e.jsx(_,{placeholder:"Statut"})}),e.jsxs(L,{children:[e.jsx(a,{value:"all",children:"Tous les statuts"}),e.jsx(a,{value:"draft",children:"Brouillon"}),e.jsx(a,{value:"pending",children:"En attente"}),e.jsx(a,{value:"approved",children:"Approuvé"}),e.jsx(a,{value:"active",children:"Actif"}),e.jsx(a,{value:"closed",children:"Clôturé"}),e.jsx(a,{value:"expired",children:"Expiré"}),e.jsx(a,{value:"rejected",children:"Rejeté"})]})]}),e.jsxs(I,{value:u,onValueChange:l,children:[e.jsx(k,{className:"text-sm h-9 sm:h-10 w-full min-w-0",children:e.jsx(_,{placeholder:"Priorité"})}),e.jsxs(L,{children:[e.jsx(a,{value:"all",children:"Toutes les priorités"}),e.jsx(a,{value:"high",children:"Haute"}),e.jsx(a,{value:"medium",children:"Moyenne"}),e.jsx(a,{value:"low",children:"Faible"})]})]}),e.jsxs(I,{value:m,onValueChange:b,children:[e.jsx(k,{className:"text-sm h-9 sm:h-10 w-full min-w-0",children:e.jsx(_,{placeholder:"Période"})}),e.jsxs(L,{children:[e.jsx(a,{value:"all",children:"Toutes les périodes"}),e.jsx(a,{value:"today",children:"Aujourd'hui"}),e.jsx(a,{value:"week",children:"Cette semaine"}),e.jsx(a,{value:"month",children:"Ce mois"}),e.jsx(a,{value:"custom",children:"Personnalisée"})]})]}),e.jsxs($,{variant:"outline",onClick:()=>{h(""),d("all"),l("all"),b("all"),w(void 0)},className:"text-sm h-9 sm:h-10 w-full sm:w-auto",children:[e.jsx("span",{className:"hidden sm:inline",children:"Réinitialiser filtres"}),e.jsx("span",{className:"sm:hidden",children:"Réinitialiser"})]})]}),m==="custom"&&e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs("div",{className:"space-y-2 max-w-xs",children:[e.jsx(ce,{className:"text-sm",children:"Sélectionner une date"}),e.jsxs(Oe,{children:[e.jsx($e,{asChild:!0,children:e.jsxs($,{variant:"outline",className:`w-full justify-start text-left font-normal text-sm ${!o&&"text-muted-foreground"}`,children:[e.jsx(Ue,{className:"mr-2 h-4 w-4"}),o?Je(o,"PPP",{locale:Ye}):e.jsx("span",{children:"Sélectionner une date"})]})}),e.jsx(He,{className:"w-auto p-0",align:"start",children:e.jsx(Ge,{mode:"single",selected:o,onSelect:w,initialFocus:!0})})]})]})})]})]}),de.length>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-stretch sm:items-center gap-3 sm:gap-4 mt-3 sm:mt-4 w-full min-w-0",children:[e.jsx("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-3 min-w-0 flex-wrap",children:e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(ce,{htmlFor:"items-per-page",className:"text-xs sm:text-sm whitespace-nowrap flex-shrink-0",children:"Éléments par page:"}),e.jsxs(I,{value:J.toString(),onValueChange:s=>De(Number(s)),children:[e.jsx(k,{className:"w-16 sm:w-20 flex-shrink-0 h-8 text-xs sm:text-sm",children:e.jsx(_,{})}),e.jsxs(L,{children:[e.jsx(a,{value:"3",children:"3"}),e.jsx(a,{value:"6",children:"6"}),e.jsx(a,{value:"9",children:"9"}),e.jsx(a,{value:"12",children:"12"}),e.jsx(a,{value:"15",children:"15"})]})]})]})}),e.jsxs("div",{className:"text-xs text-muted-foreground text-left",children:["Affichage de ",Ne+1," à ",Math.min(Ae,de.length)," sur ",de.length," demande",de.length>1?"s":""]})]}),Te()?e.jsx(e.Fragment,{children:e.jsx("div",{className:"space-y-3 sm:space-y-4 w-full min-w-0",children:z==="mine"&&Array.from({length:J}).map((s,r)=>e.jsx(p,{className:"w-full min-w-0 box-border",children:e.jsx(f,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 sm:gap-6 items-start sm:items-center",children:[e.jsxs("div",{className:"flex items-start gap-3 sm:gap-4 flex-1 min-w-0",children:[e.jsx(n,{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-full flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-wrap mb-2",children:[e.jsx(n,{className:"h-5 sm:h-6 w-32"}),e.jsx(n,{className:"h-5 w-16"}),e.jsx(n,{className:"h-5 w-20"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(n,{className:"h-4 w-40"}),e.jsx(n,{className:"h-4 w-48"})]})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2 sm:gap-3 flex-shrink-0 w-full sm:w-auto",children:[e.jsx(n,{className:"h-4 w-32"}),e.jsx(n,{className:"h-3 w-28"}),e.jsx(n,{className:"h-3 w-48"}),e.jsx(n,{className:"h-8 w-20 mt-2"})]})]})})},r))})}):z==="mine"&&ee.length===0?e.jsx(p,{className:"w-full box-border",children:e.jsxs(f,{className:"text-center py-6 sm:py-8",children:[e.jsx(ae,{className:"w-10 h-10 sm:w-12 sm:h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Aucune demande trouvée."})]})}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"space-y-3 sm:space-y-4 w-full min-w-0",children:z==="mine"&&ee.map(s=>{var r,j;return e.jsx(p,{className:"hover:shadow-lg transition-shadow w-full min-w-0 box-border",children:e.jsx(f,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 sm:gap-6 items-start sm:items-center",children:[e.jsxs("div",{className:"flex items-start gap-3 sm:gap-4 flex-shrink-0",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-primary/15 flex-shrink-0",children:e.jsx("div",{className:"text-blue-600",children:s.status==="Approuvé"||s.status==="approved"?e.jsx(Ce,{className:"w-5 h-5 sm:w-6 sm:h-6"}):se(s.status)?e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 flex items-center justify-center",children:se(s.status)}):e.jsx(ae,{className:"w-5 h-5 sm:w-6 sm:h-6"})})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-wrap mb-2",children:[e.jsx(M,{className:"text-base sm:text-lg font-bold truncate min-w-0",children:s.request_code}),e.jsx(T,{variant:"outline",className:me(s.priority)+" text-xs whitespace-nowrap flex-shrink-0",children:U(xe,s.priority)}),e.jsx(T,{className:oe(s.status)+" text-xs whitespace-nowrap flex-shrink-0",children:U(he,s.status)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:((r=s.equipment)==null?void 0:r.name)||"N/A"}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:((j=s.sensor)==null?void 0:j.name)||"N/A"})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:gap-3 flex-1 min-w-0 items-center sm:items-center",children:[e.jsx("p",{className:"text-sm font-semibold text-center truncate",children:s.requester?s.requester.full_name:"Moi"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground text-center whitespace-nowrap",children:new Date(s.created_at).toLocaleString("fr-FR",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}),s.description&&e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground text-center line-clamp-2 max-w-[300px]",children:s.description})]}),e.jsx("div",{className:"flex flex-col gap-2 sm:gap-3 flex-shrink-0 w-full sm:w-auto items-center sm:items-center",children:e.jsx("div",{className:"mt-2 flex justify-end",children:e.jsx(ue,{request:s})})})]})})},s.id)})})}),de.length>0&&O>1&&e.jsx("div",{className:"flex justify-center sm:justify-end items-center mt-4 sm:mt-6 w-full min-w-0 overflow-x-hidden",children:e.jsx(Re,{children:e.jsxs(Ee,{className:"flex-wrap min-w-0",children:[e.jsx(Q,{children:e.jsx(Ve,{href:"#",onClick:s=>{s.preventDefault(),y>1&&Z(y-1)},className:y===1?"pointer-events-none opacity-50":"cursor-pointer"})}),Array.from({length:O},(s,r)=>r+1).map(s=>e.jsx(Q,{children:e.jsx(Be,{href:"#",onClick:r=>{r.preventDefault(),Z(s)},isActive:y===s,className:"cursor-pointer",children:s})},s)),e.jsx(Q,{children:e.jsx(ze,{href:"#",onClick:s=>{s.preventDefault(),y<O&&Z(y+1)},className:y===O?"pointer-events-none opacity-50":"cursor-pointer"})})]})})})]})}),((S==null?void 0:S.role)==="administrator"||(S==null?void 0:S.role)==="supervisor")&&e.jsxs(e.Fragment,{children:[e.jsx(ke,{value:"pending",className:"space-y-4 sm:space-y-6",children:ne.length===0?e.jsxs(p,{className:"w-full box-border",children:[e.jsxs(P,{className:"p-3 sm:p-4",children:[e.jsx(M,{className:"text-sm sm:text-base",children:"En attente d'approbation"}),e.jsx(ye,{className:"text-xs sm:text-sm",children:"Demandes nécessitant une action"})]}),e.jsx(f,{className:"p-3 sm:p-4 pt-0",children:e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground text-center py-6 sm:py-8",children:"Aucune demande en attente d'approbation."})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(p,{className:"w-full box-border",children:[e.jsx(P,{className:"p-3 sm:p-4",children:e.jsxs(M,{className:"flex items-center gap-2 text-sm sm:text-base",children:[e.jsx(qe,{className:"w-4 h-4 sm:w-4 sm:h-4"}),"Filtres"]})}),e.jsxs(f,{className:"p-3 sm:p-4 pt-0 w-full min-w-0",children:[e.jsxs("div",{className:"grid gap-3 sm:gap-3 md:gap-4 lg:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 w-full min-w-0",children:[e.jsxs("div",{className:"relative sm:col-span-2 lg:col-span-1 w-full min-w-0",children:[e.jsx(Me,{className:"absolute left-2 sm:left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 sm:w-4 sm:h-4 text-muted-foreground"}),e.jsx(pe,{placeholder:"Rechercher...",value:c,onChange:s=>h(s.target.value),className:"pl-8 sm:pl-10 text-sm w-full"})]}),e.jsxs(I,{value:t,onValueChange:d,children:[e.jsx(k,{className:"text-sm h-9 sm:h-10 w-full min-w-0",children:e.jsx(_,{placeholder:"Statut"})}),e.jsxs(L,{children:[e.jsx(a,{value:"all",children:"Tous les statuts"}),e.jsx(a,{value:"draft",children:"Brouillon"}),e.jsx(a,{value:"pending",children:"En attente"}),e.jsx(a,{value:"approved",children:"Approuvé"}),e.jsx(a,{value:"active",children:"Actif"}),e.jsx(a,{value:"closed",children:"Clôturé"}),e.jsx(a,{value:"expired",children:"Expiré"}),e.jsx(a,{value:"rejected",children:"Rejeté"})]})]}),e.jsxs(I,{value:u,onValueChange:l,children:[e.jsx(k,{className:"text-sm h-9 sm:h-10 w-full min-w-0",children:e.jsx(_,{placeholder:"Priorité"})}),e.jsxs(L,{children:[e.jsx(a,{value:"all",children:"Toutes les priorités"}),e.jsx(a,{value:"high",children:"Haute"}),e.jsx(a,{value:"medium",children:"Moyenne"}),e.jsx(a,{value:"low",children:"Faible"})]})]}),e.jsxs(I,{value:m,onValueChange:b,children:[e.jsx(k,{className:"text-sm h-9 sm:h-10 w-full min-w-0",children:e.jsx(_,{placeholder:"Période"})}),e.jsxs(L,{children:[e.jsx(a,{value:"all",children:"Toutes les périodes"}),e.jsx(a,{value:"today",children:"Aujourd'hui"}),e.jsx(a,{value:"week",children:"Cette semaine"}),e.jsx(a,{value:"month",children:"Ce mois"}),e.jsx(a,{value:"custom",children:"Personnalisée"})]})]}),e.jsxs($,{variant:"outline",onClick:()=>{h(""),d("all"),l("all"),b("all"),w(void 0)},className:"text-sm h-9 sm:h-10 w-full sm:w-auto",children:[e.jsx("span",{className:"hidden sm:inline",children:"Réinitialiser filtres"}),e.jsx("span",{className:"sm:hidden",children:"Réinitialiser"})]})]}),m==="custom"&&e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs("div",{className:"space-y-2 max-w-xs",children:[e.jsx(ce,{className:"text-sm",children:"Sélectionner une date"}),e.jsxs(Oe,{children:[e.jsx($e,{asChild:!0,children:e.jsxs($,{variant:"outline",className:`w-full justify-start text-left font-normal text-sm ${!o&&"text-muted-foreground"}`,children:[e.jsx(Ue,{className:"mr-2 h-4 w-4"}),o?Je(o,"PPP",{locale:Ye}):e.jsx("span",{children:"Sélectionner une date"})]})}),e.jsx(He,{className:"w-auto p-0",align:"start",children:e.jsx(Ge,{mode:"single",selected:o,onSelect:w,initialFocus:!0})})]})]})})]})]}),we.length>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-stretch sm:items-center gap-3 sm:gap-4 mt-3 sm:mt-4 w-full min-w-0",children:[e.jsx("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-3 min-w-0 flex-wrap",children:e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(ce,{htmlFor:"items-per-page",className:"text-xs sm:text-sm whitespace-nowrap flex-shrink-0",children:"Éléments par page:"}),e.jsxs(I,{value:J.toString(),onValueChange:s=>De(Number(s)),children:[e.jsx(k,{className:"w-16 sm:w-20 flex-shrink-0 h-8 text-xs sm:text-sm",children:e.jsx(_,{})}),e.jsxs(L,{children:[e.jsx(a,{value:"3",children:"3"}),e.jsx(a,{value:"6",children:"6"}),e.jsx(a,{value:"9",children:"9"}),e.jsx(a,{value:"12",children:"12"}),e.jsx(a,{value:"15",children:"15"})]})]})]})}),e.jsxs("div",{className:"text-xs text-muted-foreground text-left",children:["Affichage de ",Ne+1," à ",Math.min(Ae,we.length)," sur ",we.length," demande",we.length>1?"s":""]})]}),Te()?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:hidden gap-3 sm:gap-3 md:gap-4 w-full min-w-0",children:Array.from({length:J}).map((s,r)=>e.jsxs(p,{className:"flex flex-col h-full w-full min-w-0 box-border",children:[e.jsxs(P,{className:"pb-4 p-6 min-w-0",children:[e.jsx("div",{className:"flex items-start justify-between gap-1.5 min-w-0",children:e.jsxs("div",{className:"flex items-center gap-1.5 min-w-0 flex-1",children:[e.jsx(n,{className:"w-6 h-6 rounded-full"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx(n,{className:"h-5 w-32 mb-2"}),e.jsx(n,{className:"h-4 w-24"})]})]})}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-3 flex-wrap",children:[e.jsx(n,{className:"h-5 w-16"}),e.jsx(n,{className:"h-5 w-20"})]})]}),e.jsxs(f,{className:"space-y-1.5 p-6 pt-0 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"h-3 w-20"}),e.jsx(n,{className:"h-3 w-24"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"h-3 w-12"}),e.jsx(n,{className:"h-3 w-28"})]}),e.jsx(n,{className:"h-3 w-full mt-2"}),e.jsx(n,{className:"h-8 w-24 mt-2"})]})]},r))}),e.jsx("div",{className:"hidden lg:block space-y-3 sm:space-y-4 md:space-y-6 w-full min-w-0",children:Array.from({length:J}).map((s,r)=>e.jsxs(p,{className:"w-full min-w-0 box-border",children:[e.jsx(P,{className:"p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[e.jsx(n,{className:"w-8 h-8 rounded-full"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx(n,{className:"h-4 w-32 mb-2"}),e.jsx(n,{className:"h-3 w-48"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx(n,{className:"h-5 w-16"}),e.jsx(n,{className:"h-5 w-20"})]})]})}),e.jsxs(f,{className:"p-3 sm:p-4 pt-0 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[e.jsx(n,{className:"h-3 w-20"}),e.jsx(n,{className:"h-3 w-32"})]}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(n,{className:"h-3 w-12"}),e.jsx(n,{className:"h-3 w-36"})]})]}),e.jsx(n,{className:"h-3 w-full mt-3 pt-3"}),e.jsx(n,{className:"h-8 w-28 mt-3"})]})]},r))})]}):z==="pending"&&ee.length===0?e.jsx(p,{className:"w-full box-border",children:e.jsxs(f,{className:"text-center py-6 sm:py-8",children:[e.jsx(ae,{className:"w-10 h-10 sm:w-12 sm:h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Aucune demande trouvée."})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:hidden gap-3 sm:gap-3 md:gap-4 w-full min-w-0",children:z==="pending"&&ee.map(s=>{var r,j,v;return e.jsxs(p,{className:"hover:shadow-lg transition-shadow flex flex-col h-full w-full min-w-0 box-border",children:[e.jsxs(P,{className:"pb-4 p-6 min-w-0",children:[e.jsx("div",{className:"flex items-start justify-between gap-1.5 min-w-0",children:e.jsxs("div",{className:"flex items-center gap-1.5 min-w-0 flex-1",children:[e.jsx("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-primary/10 flex-shrink-0",children:se(s.status)}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx(M,{className:"text-lg truncate min-w-0",children:s.request_code}),e.jsxs(ye,{className:"text-xs line-clamp-2 mt-1.5 min-w-0",children:[((r=s.equipment)==null?void 0:r.name)||"N/A"," - ",((j=s.sensor)==null?void 0:j.name)||"N/A"]})]})]})}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-3 flex-wrap",children:[e.jsx(T,{variant:"outline",className:me(s.priority)+" text-xs whitespace-nowrap flex-shrink-0",children:U(xe,s.priority)}),e.jsx(T,{className:oe(s.status)+" text-xs whitespace-nowrap flex-shrink-0",children:U(he,s.status)})]})]}),e.jsxs(f,{className:"space-y-1.5 p-6 pt-0 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between min-w-0",children:[e.jsx("span",{className:"text-xs text-muted-foreground truncate",children:"Demandeur:"}),e.jsx("span",{className:"text-xs truncate",children:((v=s.requester)==null?void 0:v.full_name)||"N/A"})]}),e.jsxs("div",{className:"flex items-center justify-between min-w-0",children:[e.jsx("span",{className:"text-xs text-muted-foreground truncate",children:"Date:"}),e.jsx("span",{className:"text-xs truncate whitespace-nowrap",children:new Date(s.created_at).toLocaleString("fr-FR",{dateStyle:"short",timeStyle:"short"})})]}),s.description&&e.jsx("div",{className:"pt-1",children:e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2 min-w-0",children:s.description})}),e.jsx("div",{className:"pt-2",children:e.jsx(ue,{request:s})})]})]},s.id)})}),e.jsx("div",{className:"hidden lg:block space-y-3 sm:space-y-4 md:space-y-6 w-full min-w-0",children:z==="pending"&&ee.map(s=>{var r,j,v;return e.jsx(p,{className:"hover:shadow-lg transition-shadow w-full min-w-0 box-border",children:e.jsx(f,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 sm:gap-6 items-start sm:items-center",children:[e.jsxs("div",{className:"flex items-start gap-3 sm:gap-4 flex-shrink-0",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-primary/15 flex-shrink-0",children:e.jsx("div",{className:"text-blue-600",children:s.status==="Approuvé"||s.status==="approved"?e.jsx(Ce,{className:"w-5 h-5 sm:w-6 sm:h-6"}):se(s.status)?e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 flex items-center justify-center",children:se(s.status)}):e.jsx(ae,{className:"w-5 h-5 sm:w-6 sm:h-6"})})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-wrap mb-2",children:[e.jsx(M,{className:"text-base sm:text-lg font-bold truncate min-w-0",children:s.request_code}),e.jsx(T,{variant:"outline",className:me(s.priority)+" text-xs whitespace-nowrap flex-shrink-0",children:U(xe,s.priority)}),e.jsx(T,{className:oe(s.status)+" text-xs whitespace-nowrap flex-shrink-0",children:U(he,s.status)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:((r=s.equipment)==null?void 0:r.name)||"N/A"}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:((j=s.sensor)==null?void 0:j.name)||"N/A"})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:gap-3 flex-1 min-w-0 items-center sm:items-center",children:[e.jsx("p",{className:"text-sm font-semibold text-center truncate",children:((v=s.requester)==null?void 0:v.full_name)||"N/A"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground text-center whitespace-nowrap",children:new Date(s.created_at).toLocaleString("fr-FR",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}),s.description&&e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground text-center line-clamp-2 max-w-[300px]",children:s.description})]}),e.jsx("div",{className:"flex flex-col gap-2 sm:gap-3 flex-shrink-0 w-full sm:w-auto items-center sm:items-center",children:e.jsx("div",{className:"mt-2 flex justify-end",children:e.jsx(ue,{request:s})})})]})})},s.id)})})]}),we.length>0&&O>1&&e.jsx("div",{className:"flex justify-center sm:justify-end items-center mt-4 sm:mt-6 w-full min-w-0 overflow-x-hidden",children:e.jsx(Re,{children:e.jsxs(Ee,{className:"flex-wrap min-w-0",children:[e.jsx(Q,{children:e.jsx(Ve,{href:"#",onClick:s=>{s.preventDefault(),y>1&&Z(y-1)},className:y===1?"pointer-events-none opacity-50":"cursor-pointer"})}),Array.from({length:O},(s,r)=>r+1).map(s=>e.jsx(Q,{children:e.jsx(Be,{href:"#",onClick:r=>{r.preventDefault(),Z(s)},isActive:y===s,className:"cursor-pointer",children:s})},s)),e.jsx(Q,{children:e.jsx(ze,{href:"#",onClick:s=>{s.preventDefault(),y<O&&Z(y+1)},className:y===O?"pointer-events-none opacity-50":"cursor-pointer"})})]})})})]})}),e.jsx(ke,{value:"active",className:"space-y-4 sm:space-y-6",children:C.length===0?e.jsxs(p,{className:"w-full box-border",children:[e.jsxs(P,{className:"p-3 sm:p-4",children:[e.jsx(M,{className:"text-sm sm:text-base",children:"Bypass actifs"}),e.jsx(ye,{className:"text-xs sm:text-sm",children:"Demandes de bypass actuellement actives"})]}),e.jsx(f,{className:"p-3 sm:p-4 pt-0",children:e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground text-center py-6 sm:py-8",children:"Aucun bypass actif."})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(p,{className:"w-full box-border",children:[e.jsx(P,{className:"p-3 sm:p-4",children:e.jsxs(M,{className:"flex items-center gap-2 text-sm sm:text-base",children:[e.jsx(qe,{className:"w-4 h-4 sm:w-4 sm:h-4"}),"Filtres"]})}),e.jsxs(f,{className:"p-4 sm:p-6 w-full min-w-0",children:[e.jsxs("div",{className:"grid gap-3 grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 w-full min-w-0",children:[e.jsxs("div",{className:"relative sm:col-span-2 lg:col-span-1 w-full min-w-0",children:[e.jsx(Me,{className:"absolute left-2 top-2.5 h-3.5 w-3.5 sm:h-4 sm:w-4 text-muted-foreground"}),e.jsx(pe,{placeholder:"Rechercher...",value:c,onChange:s=>h(s.target.value),className:"pl-8 sm:pl-10 w-full text-sm"})]}),e.jsxs(I,{value:t,onValueChange:d,children:[e.jsx(k,{className:"text-sm w-full min-w-0",children:e.jsx(_,{placeholder:"Statut"})}),e.jsxs(L,{children:[e.jsx(a,{value:"all",children:"Tous les statuts"}),e.jsx(a,{value:"draft",children:"Brouillon"}),e.jsx(a,{value:"pending",children:"En attente"}),e.jsx(a,{value:"approved",children:"Approuvé"}),e.jsx(a,{value:"active",children:"Actif"}),e.jsx(a,{value:"closed",children:"Clôturé"}),e.jsx(a,{value:"expired",children:"Expiré"}),e.jsx(a,{value:"rejected",children:"Rejeté"})]})]}),e.jsxs(I,{value:u,onValueChange:l,children:[e.jsx(k,{className:"text-sm w-full min-w-0",children:e.jsx(_,{placeholder:"Priorité"})}),e.jsxs(L,{children:[e.jsx(a,{value:"all",children:"Toutes les priorités"}),e.jsx(a,{value:"high",children:"Haute"}),e.jsx(a,{value:"medium",children:"Moyenne"}),e.jsx(a,{value:"low",children:"Faible"})]})]}),e.jsxs(I,{value:m,onValueChange:b,children:[e.jsx(k,{className:"text-sm w-full min-w-0",children:e.jsx(_,{placeholder:"Période"})}),e.jsxs(L,{children:[e.jsx(a,{value:"all",children:"Toutes les périodes"}),e.jsx(a,{value:"today",children:"Aujourd'hui"}),e.jsx(a,{value:"week",children:"Cette semaine"}),e.jsx(a,{value:"month",children:"Ce mois"}),e.jsx(a,{value:"custom",children:"Personnalisée"})]})]}),e.jsxs($,{variant:"outline",onClick:()=>{h(""),d("all"),l("all"),b("all"),w(void 0)},className:"text-sm w-full sm:w-auto min-w-0 truncate",children:[e.jsx("span",{className:"hidden sm:inline truncate",children:"Réinitialiser filtres"}),e.jsx("span",{className:"sm:hidden truncate",children:"Réinitialiser"})]})]}),m==="custom"&&e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs("div",{className:"space-y-2 max-w-xs",children:[e.jsx(ce,{className:"text-sm",children:"Sélectionner une date"}),e.jsxs(Oe,{children:[e.jsx($e,{asChild:!0,children:e.jsxs($,{variant:"outline",className:`w-full justify-start text-left font-normal text-sm ${!o&&"text-muted-foreground"}`,children:[e.jsx(Ue,{className:"mr-2 h-4 w-4"}),o?Je(o,"PPP",{locale:Ye}):e.jsx("span",{children:"Sélectionner une date"})]})}),e.jsx(He,{className:"w-auto p-0",align:"start",children:e.jsx(Ge,{mode:"single",selected:o,onSelect:w,initialFocus:!0})})]})]})})]})]}),ve.length>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-stretch sm:items-center gap-3 sm:gap-4 mt-3 sm:mt-4 w-full min-w-0",children:[e.jsx("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-3 min-w-0 flex-wrap",children:e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(ce,{htmlFor:"items-per-page",className:"text-xs sm:text-sm whitespace-nowrap flex-shrink-0",children:"Éléments par page:"}),e.jsxs(I,{value:J.toString(),onValueChange:s=>De(Number(s)),children:[e.jsx(k,{className:"w-16 sm:w-20 flex-shrink-0 h-8 text-xs sm:text-sm",children:e.jsx(_,{})}),e.jsxs(L,{children:[e.jsx(a,{value:"3",children:"3"}),e.jsx(a,{value:"6",children:"6"}),e.jsx(a,{value:"9",children:"9"}),e.jsx(a,{value:"12",children:"12"}),e.jsx(a,{value:"15",children:"15"})]})]})]})}),e.jsxs("div",{className:"text-xs text-muted-foreground text-left",children:["Affichage de ",Ne+1," à ",Math.min(Ae,ve.length)," sur ",ve.length," demande",ve.length>1?"s":""]})]}),Te()?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:hidden gap-3 sm:gap-3 md:gap-4 w-full min-w-0",children:Array.from({length:J}).map((s,r)=>e.jsxs(p,{className:"flex flex-col h-full w-full min-w-0 box-border",children:[e.jsxs(P,{className:"pb-4 p-6 min-w-0",children:[e.jsx("div",{className:"flex items-start justify-between gap-1.5 min-w-0",children:e.jsxs("div",{className:"flex items-center gap-1.5 min-w-0 flex-1",children:[e.jsx(n,{className:"w-6 h-6 rounded-full"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx(n,{className:"h-5 w-32 mb-2"}),e.jsx(n,{className:"h-4 w-24"})]})]})}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-3 flex-wrap",children:[e.jsx(n,{className:"h-5 w-16"}),e.jsx(n,{className:"h-5 w-20"})]})]}),e.jsxs(f,{className:"space-y-1.5 p-6 pt-0 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"h-3 w-20"}),e.jsx(n,{className:"h-3 w-24"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"h-3 w-12"}),e.jsx(n,{className:"h-3 w-28"})]}),e.jsx(n,{className:"h-3 w-full mt-2"}),e.jsx(n,{className:"h-8 w-24 mt-2"})]})]},r))}),e.jsx("div",{className:"hidden lg:block space-y-3 sm:space-y-4 md:space-y-6 w-full min-w-0",children:Array.from({length:J}).map((s,r)=>e.jsxs(p,{className:"w-full min-w-0 box-border",children:[e.jsx(P,{className:"p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[e.jsx(n,{className:"w-8 h-8 rounded-full"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx(n,{className:"h-4 w-32 mb-2"}),e.jsx(n,{className:"h-3 w-48"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx(n,{className:"h-5 w-16"}),e.jsx(n,{className:"h-5 w-20"})]})]})}),e.jsxs(f,{className:"p-3 sm:p-4 pt-0 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[e.jsx(n,{className:"h-3 w-20"}),e.jsx(n,{className:"h-3 w-32"})]}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(n,{className:"h-3 w-12"}),e.jsx(n,{className:"h-3 w-36"})]})]}),e.jsx(n,{className:"h-3 w-full mt-3 pt-3"}),e.jsx(n,{className:"h-8 w-28 mt-3"})]})]},r))})]}):z==="active"&&ee.length===0?e.jsx(p,{className:"w-full box-border",children:e.jsxs(f,{className:"text-center py-6 sm:py-8",children:[e.jsx(ae,{className:"w-10 h-10 sm:w-12 sm:h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Aucune demande trouvée."})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:hidden gap-3 sm:gap-3 md:gap-4 w-full min-w-0",children:z==="active"&&ee.map(s=>{var r,j,v;return e.jsxs(p,{className:"hover:shadow-lg transition-shadow flex flex-col h-full w-full min-w-0 box-border",children:[e.jsxs(P,{className:"pb-4 p-6 min-w-0",children:[e.jsx("div",{className:"flex items-start justify-between gap-1.5 min-w-0",children:e.jsxs("div",{className:"flex items-center gap-1.5 min-w-0 flex-1",children:[e.jsx("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-primary/10 flex-shrink-0",children:se(s.status)}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx(M,{className:"text-lg truncate min-w-0",children:s.request_code}),e.jsxs(ye,{className:"text-xs line-clamp-2 mt-1.5 min-w-0",children:[((r=s.equipment)==null?void 0:r.name)||"N/A"," - ",((j=s.sensor)==null?void 0:j.name)||"N/A"]})]})]})}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-3 flex-wrap",children:[e.jsx(T,{variant:"outline",className:me(s.priority)+" text-xs whitespace-nowrap flex-shrink-0",children:U(xe,s.priority)}),e.jsx(T,{className:oe(s.status)+" text-xs whitespace-nowrap flex-shrink-0",children:U(he,s.status)})]})]}),e.jsxs(f,{className:"space-y-1.5 p-6 pt-0 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between min-w-0",children:[e.jsx("span",{className:"text-xs text-muted-foreground truncate",children:"Demandeur:"}),e.jsx("span",{className:"text-xs truncate",children:((v=s.requester)==null?void 0:v.full_name)||"N/A"})]}),e.jsxs("div",{className:"flex items-center justify-between min-w-0",children:[e.jsx("span",{className:"text-xs text-muted-foreground truncate",children:"Date:"}),e.jsx("span",{className:"text-xs truncate whitespace-nowrap",children:new Date(s.created_at).toLocaleString("fr-FR",{dateStyle:"short",timeStyle:"short"})})]}),s.description&&e.jsx("div",{className:"pt-1",children:e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2 min-w-0",children:s.description})}),e.jsx("div",{className:"pt-2",children:e.jsx(ue,{request:s})})]})]},s.id)})}),e.jsx("div",{className:"hidden lg:block space-y-3 sm:space-y-4 md:space-y-6 w-full min-w-0",children:z==="active"&&ee.map(s=>{var r,j,v;return e.jsx(p,{className:"hover:shadow-lg transition-shadow w-full min-w-0 box-border",children:e.jsx(f,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 sm:gap-6 items-start sm:items-center",children:[e.jsxs("div",{className:"flex items-start gap-3 sm:gap-4 flex-shrink-0",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-primary/15 flex-shrink-0",children:e.jsx("div",{className:"text-blue-600",children:s.status==="Approuvé"||s.status==="approved"?e.jsx(Ce,{className:"w-5 h-5 sm:w-6 sm:h-6"}):se(s.status)?e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 flex items-center justify-center",children:se(s.status)}):e.jsx(ae,{className:"w-5 h-5 sm:w-6 sm:h-6"})})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-wrap mb-2",children:[e.jsx(M,{className:"text-base sm:text-lg font-bold truncate min-w-0",children:s.request_code}),e.jsx(T,{variant:"outline",className:me(s.priority)+" text-xs whitespace-nowrap flex-shrink-0",children:U(xe,s.priority)}),e.jsx(T,{className:oe(s.status)+" text-xs whitespace-nowrap flex-shrink-0",children:U(he,s.status)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:((r=s.equipment)==null?void 0:r.name)||"N/A"}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:((j=s.sensor)==null?void 0:j.name)||"N/A"})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:gap-3 flex-1 min-w-0 items-center sm:items-center",children:[e.jsx("p",{className:"text-sm font-semibold text-center truncate",children:((v=s.requester)==null?void 0:v.full_name)||"N/A"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground text-center whitespace-nowrap",children:new Date(s.created_at).toLocaleString("fr-FR",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}),s.description&&e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground text-center line-clamp-2 max-w-[300px]",children:s.description})]}),e.jsx("div",{className:"flex flex-col gap-2 sm:gap-3 flex-shrink-0 w-full sm:w-auto items-center sm:items-center",children:e.jsx("div",{className:"mt-2 flex justify-end",children:e.jsx(ue,{request:s})})})]})})},s.id)})})]}),ve.length>0&&O>1&&e.jsx("div",{className:"flex justify-center sm:justify-end items-center mt-4 sm:mt-6 w-full min-w-0 overflow-x-hidden",children:e.jsx(Re,{children:e.jsxs(Ee,{className:"flex-wrap min-w-0",children:[e.jsx(Q,{children:e.jsx(Ve,{href:"#",onClick:s=>{s.preventDefault(),y>1&&Z(y-1)},className:y===1?"pointer-events-none opacity-50":"cursor-pointer"})}),Array.from({length:O},(s,r)=>r+1).map(s=>e.jsx(Q,{children:e.jsx(Be,{href:"#",onClick:r=>{r.preventDefault(),Z(s)},isActive:y===s,className:"cursor-pointer",children:s})},s)),e.jsx(Q,{children:e.jsx(ze,{href:"#",onClick:s=>{s.preventDefault(),y<O&&Z(y+1)},className:y===O?"pointer-events-none opacity-50":"cursor-pointer"})})]})})})]})})]})]})]})}export{et as default};
